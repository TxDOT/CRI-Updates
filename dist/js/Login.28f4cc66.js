(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Login"],{a55b:function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-dialog",{attrs:{persistent:"","max-width":"500",id:"cardDisplay"},model:{value:t.disagree,callback:function(e){t.disagree=e},expression:"disagree"}},[n("v-card",{staticStyle:{"border-radius":"0px"},attrs:{height:"250"},model:{value:t.disagree,callback:function(e){t.disagree=e},expression:"disagree"}},[n("v-card-actions",[!1===t.certify?n("div",{attrs:{id:"loginBannerPos"}},[n("v-alert",{attrs:{color:"#14375A",border:"top",dark:"",id:"loginBannerTxt"},domProps:{innerHTML:t._s(t.statusMessageFalse)}})],1):t._e(),n("div",{staticClass:"black--text mb-3",attrs:{id:"loginTxt"}},[n("v-card-text",{staticStyle:{color:"black"},domProps:{innerHTML:t._s(t.disagreeTxt)}})],1),n("div",{attrs:{id:"loginBtnPos"}},[n("v-btn",{attrs:{id:"loginButton",outlined:"",tile:"",color:"#14375A"},on:{click:function(e){t.disagree=!1,t.logMeIn()}}},[n("u",[t._v("Login")])])],1),n("v-btn",{attrs:{id:"SignupBtnPos",depressed:"",text:"",tile:"",color:"black","x-small":"",onclick:"window.open('https://www.txdot.gov/data-maps/roadway-inventory/cri-form.html','_blank')"}},[t._v(" Sign-Up ")])],1)],1)],1)},s=[],a=n("1da1"),o=(n("96cf"),n("99af"),n("7db0"),n("d3b7"),n("b64b"),n("ac1f"),n("1276"),n("caad"),n("2532"),n("5319"),n("e9c4"),n("a9e3"),n("3514")),i=n("9e3e"),u=n("1baa"),c=n("f793"),d=n("d81c8"),l=n("0224"),g=n("69dd"),m={name:"Login",props:["id"],data:function(){return{statusMessageTrue:"",statusMessageFalse:"",certify:!1,disagree:!0,countyPopup:!1,disagreeTxt:"<br><br>Click the Login button and use your TxDOT-provided credentials to access the County Road Inventory Map. If you do not have an account, click the Sign-Up button to register.",judgeName:"",county:"",auth:{},cntyNme:"",loginToMap:!1}},beforeRouteLeave:function(t,e,n){this.loginToMap?n():n(!1)},mounted:function(){var t=this;this.auth=new c["a"]({appId:"9XWrQUJ2eX0jXEAW",expiration:10080,popup:!1}),d["default"].registerOAuthInfos([this.auth]),d["default"].checkSignInStatus("https://txdot.maps.arcgis.com/sharing").then((function(){t.handleSignedIn()})).catch((function(t){console.log(t)})),this.certify=!1;var e=new Date;this.certiAlert="<p>By clicking submit, you are certifying the mileage for your county and completing the process for ".concat(e.getFullYear()-1,".<br> Edits made in ").concat(e.getFullYear()," after certifying are allowed, but will need to be recertified by the county judge prior to <DATE> in order to be accepted."),e.toDateString(),this.statusMessageFalse="The TxDOT County Road Inventory Map"},methods:{logMeIn:function(){d["default"].getCredential(this.auth.portalUrl+"/sharing"),console.log("logging in")},loadMap:function(t,e){var n=this;return Object(a["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,Object(i["b"])(t,e);case 2:n.$router.push("/map"),n.loginToMap=!1;case 4:case"end":return r.stop()}}),r)})))()},handleSignedIn:function(){var t=this,e=new l["a"];this.loginToMap=!0,e.load().then(Object(a["a"])(regeneratorRuntime.mark((function n(){var r,s,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(console.log(e.user.email),t.usrEmail=e.user.email,t.$router.push("/load"),Object(i["c"])(e.user.fetchGroups()),t.userName=e.user.username,!localStorage.getItem("county")){n.next=9;break}n.t0=JSON.parse(localStorage.getItem("county")),n.next=12;break;case 9:return n.next=11,t.getCountyInfo(e.user.username);case 11:n.t0=n.sent;case 12:if(r=n.t0,r){n.next=15;break}return n.abrupt("return");case 15:s=r[1],a=r[0],t.countyName=a,t.countyNumber=s,t.countyMiles=r[2],t.loadMap(a,s);case 21:case"end":return n.stop()}}),n)}))))},getCountyInfo:function(t){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function n(){var r,s,a,i,c;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(s=Object.keys(u["a"][0]).find((function(e){var n=t.split("_");if(n[1].toLowerCase().includes(u["a"][0][e].replace(/\s/,"").toLowerCase()))return r=u["a"][0][e],u["a"][0]})),!s){n.next=18;break}return a="CNTY_NBR = '".concat(s,"'"),i=new g["a"],i.where=a,i.outFields=["*"],n.next=8,o["countyOfficialInfo"].queryFeatures(i);case 8:return c=n.sent,console.log(c),e.countyNumber=s,e.judgeCntyOid=c.features[0].attributes["OBJECTID_1"],e.judgeNameSend=c.features[0].attributes["JUDGE_NM"],e.judgeEmailSend=c.features[0].attributes["JUDGE_EML"],localStorage.setItem("county",JSON.stringify([r,s,c.features[0].attributes["TOT_MLGE"]])),n.abrupt("return",[r,Number(s),c.features[0].attributes["TOT_MLGE"]]);case 18:return e.$router.push({name:"PickCounty"}),n.abrupt("return");case 20:case"end":return n.stop()}}),n)})))()}},computed:{setLogOut:{get:function(){return this.$store.state.isLoggedOut},set:function(t){this.$store.commit("setIsLoggedOut",t)}},countyName:{get:function(){return this.$store.state.cntyName},set:function(t){this.$store.commit("setCntyName",t)}},countyNumber:{get:function(){return this.$store.state.cntyNmbr},set:function(t){this.$store.commit("setCntyNmbr",t)}},countyMiles:{get:function(){return this.$store.state.cntyMiles},set:function(t){this.$store.commit("setCntyMiles",t)}},userName:{get:function(){return this.$store.state.username},set:function(t){this.$store.commit("setUserName",t)}},usrEmail:{get:function(){return this.$store.state.userEmail},set:function(t){this.$store.commit("setUserEmail",t)}},logIn:{get:function(){return this.$store.state.isLoggedIn},set:function(t){this.$store.commit("setIsLoggedIn",t)}},judgeNameSend:{get:function(){return this.$store.state.judgeName},set:function(t){this.$store.commit("setJudgeName",t)}},judgeEmailSend:{get:function(){return this.$store.state.judgeEmail},set:function(t){this.$store.commit("setJudgeEmail",t)}},judgeCntyOid:{get:function(){return this.$store.state.judgeObjectId},set:function(t){this.$store.commit("setJudgeObjectId",t)}}}},f=m,h=(n("d6db"),n("2877")),p=Object(h["a"])(f,r,s,!1,null,null,null);e["default"]=p.exports},d6db:function(t,e,n){"use strict";n("e67a")},e67a:function(t,e,n){}}]);
//# sourceMappingURL=Login.28f4cc66.js.map