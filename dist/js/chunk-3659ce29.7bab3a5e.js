(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3659ce29"],{"003f":function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=r("f2e0");class i{constructor(){this.id=Object(n["a"])()}unload(){}}},"0278":function(t,e,r){"use strict";r.d(e,"a",(function(){return d}));var n=r("b2b2"),i=r("8a44"),s=r("e431"),o=r("0b2d"),a=r("1153");class c{constructor(t,e,r,n){this.primitiveIndices=t,this._numIndexPerPrimitive=e,this.indices=r,this.position=n,this.center=Object(o["f"])(),Object(a["a"])(t.length>=1),Object(a["a"])(r.length%this._numIndexPerPrimitive==0),Object(a["a"])(r.length>=t.length*this._numIndexPerPrimitive),Object(a["a"])(3===n.size||4===n.size);const{data:i,size:c}=n,f=t.length;let l=c*r[this._numIndexPerPrimitive*t[0]];u.clear(),u.push(l),this.bbMin=Object(o["h"])(i[l],i[l+1],i[l+2]),this.bbMax=Object(o["d"])(this.bbMin);for(let s=0;s<f;++s){const e=this._numIndexPerPrimitive*t[s];for(let t=0;t<this._numIndexPerPrimitive;++t){l=c*r[e+t],u.push(l);let n=i[l];this.bbMin[0]=Math.min(n,this.bbMin[0]),this.bbMax[0]=Math.max(n,this.bbMax[0]),n=i[l+1],this.bbMin[1]=Math.min(n,this.bbMin[1]),this.bbMax[1]=Math.max(n,this.bbMax[1]),n=i[l+2],this.bbMin[2]=Math.min(n,this.bbMin[2]),this.bbMax[2]=Math.max(n,this.bbMax[2])}}Object(s["i"])(this.center,this.bbMin,this.bbMax,.5),this.radius=.5*Math.max(Math.max(this.bbMax[0]-this.bbMin[0],this.bbMax[1]-this.bbMin[1]),this.bbMax[2]-this.bbMin[2]);let d=this.radius*this.radius;for(let s=0;s<u.length;++s){l=u.getItemAt(s);const t=i[l]-this.center[0],e=i[l+1]-this.center[1],r=i[l+2]-this.center[2],n=t*t+e*e+r*r;if(n<=d)continue;const o=Math.sqrt(n),a=.5*(o-this.radius);this.radius=this.radius+a,d=this.radius*this.radius;const c=a/o;this.center[0]+=t*c,this.center[1]+=e*c,this.center[2]+=r*c}u.clear()}getCenter(){return this.center}getBSRadius(){return this.radius}getBBMin(){return this.bbMin}getBBMax(){return this.bbMax}getChildren(){if(this._children)return this._children;if(Object(s["l"])(this.bbMin,this.bbMax)>1){const t=Object(s["i"])(Object(o["f"])(),this.bbMin,this.bbMax,.5),e=this.primitiveIndices.length,r=new Uint8Array(e),n=new Array(8);for(let s=0;s<8;++s)n[s]=0;const{data:i,size:a}=this.position;for(let s=0;s<e;++s){let e=0;const o=this._numIndexPerPrimitive*this.primitiveIndices[s];let c=a*this.indices[o],u=i[c],f=i[c+1],l=i[c+2];for(let t=1;t<this._numIndexPerPrimitive;++t){c=a*this.indices[o+t];const e=i[c],r=i[c+1],n=i[c+2];e<u&&(u=e),r<f&&(f=r),n<l&&(l=n)}u<t[0]&&(e|=1),f<t[1]&&(e|=2),l<t[2]&&(e|=4),r[s]=e,++n[e]}let u=0;for(let s=0;s<8;++s)n[s]>0&&++u;if(u<2)return;const f=new Array(8);for(let s=0;s<8;++s)f[s]=n[s]>0?new Uint32Array(n[s]):void 0;for(let s=0;s<8;++s)n[s]=0;for(let s=0;s<e;++s){const t=r[s];f[t][n[t]++]=this.primitiveIndices[s]}this._children=new Array(8);for(let s=0;s<8;++s)void 0!==f[s]&&(this._children[s]=new c(f[s],this._numIndexPerPrimitive,this.indices,this.position))}return this._children}static prune(){u.prune()}}const u=new i["a"]({deallocator:null});var f=r("003f"),l=r("1038");class d extends f["a"]{constructor(t,e=[],r=0,n=-1){super(),this._primitiveType=r,this.edgeIndicesLength=n,this.type=2,this._vertexAttributes=new Map,this._indices=new Map,this._boundingInfo=null;for(const[i,s]of t)s&&this._vertexAttributes.set(i,{...s});if(null==e||0===e.length){const t=h(this._vertexAttributes),e=Object(l["d"])(t);this.edgeIndicesLength=this.edgeIndicesLength<0?t:this.edgeIndicesLength;for(const r of this._vertexAttributes.keys())this._indices.set(r,e)}else for(const[i,s]of e)s&&(this._indices.set(i,p(s)),"position"===i&&(this.edgeIndicesLength=this.edgeIndicesLength<0?this._indices.get(i).length:this.edgeIndicesLength))}get vertexAttributes(){return this._vertexAttributes}getMutableAttribute(t){const e=this._vertexAttributes.get(t);return e&&!e.exclusive&&(e.data=Array.from(e.data),e.exclusive=!0),e}get indices(){return this._indices}get indexCount(){const t=this._indices.values().next().value;return t?t.length:0}get primitiveType(){return this._primitiveType}get faceCount(){return this.indexCount/3}get boundingInfo(){return Object(n["k"])(this._boundingInfo)&&(this._boundingInfo=this._calculateBoundingInfo()),this._boundingInfo}computeAttachmentOrigin(t){return 0===this.primitiveType?this.computeAttachmentOriginTriangles(t):this.computeAttachmentOriginPoints(t)}computeAttachmentOriginTriangles(t){const e=this.indices.get("position"),r=this.vertexAttributes.get("position");return Object(l["c"])(r,e,t)}computeAttachmentOriginPoints(t){const e=this.indices.get("position"),r=this.vertexAttributes.get("position");return Object(l["b"])(r,e,t)}invalidateBoundingInfo(){this._boundingInfo=null}_calculateBoundingInfo(){const t=this.indices.get("position");if(0===t.length)return null;const e=0===this.primitiveType?3:1;Object(a["a"])(t.length%e==0,"Indexing error: "+t.length+" not divisible by "+e);const r=Object(l["d"])(t.length/e),n=this.vertexAttributes.get("position");return new c(r,e,t,n)}}function h(t){const e=t.values().next().value;return null==e?0:e.data.length/e.size}function p(t){if(t.BYTES_PER_ELEMENT===Uint16Array.BYTES_PER_ELEMENT)return t;for(const e of t)if(e>=65536)return t;return new Uint16Array(t)}},"04f0":function(t,e,r){"use strict";r.d(e,"a",(function(){return _})),r.d(e,"b",(function(){return l})),r.d(e,"c",(function(){return y})),r.d(e,"d",(function(){return C})),r.d(e,"e",(function(){return x})),r.d(e,"f",(function(){return d})),r.d(e,"g",(function(){return N})),r.d(e,"h",(function(){return f}));var n=r("dae5"),i=r("b139"),s=r("0b2d"),o=r("4212"),a=r("e431"),c=r("7577");function u(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function f(t,e,r){r*=.5;const n=Math.sin(r);return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=Math.cos(r),t}function l(t,e){const r=2*Math.acos(e[3]),n=Math.sin(r/2);return n>o["a"]?(t[0]=e[0]/n,t[1]=e[1]/n,t[2]=e[2]/n):(t[0]=1,t[1]=0,t[2]=0),r}function d(t,e,r){const n=e[0],i=e[1],s=e[2],o=e[3],a=r[0],c=r[1],u=r[2],f=r[3];return t[0]=n*f+o*a+i*u-s*c,t[1]=i*f+o*c+s*a-n*u,t[2]=s*f+o*u+n*c-i*a,t[3]=o*f-n*a-i*c-s*u,t}function h(t,e,r){r*=.5;const n=e[0],i=e[1],s=e[2],o=e[3],a=Math.sin(r),c=Math.cos(r);return t[0]=n*c+o*a,t[1]=i*c+s*a,t[2]=s*c-i*a,t[3]=o*c-n*a,t}function p(t,e,r){r*=.5;const n=e[0],i=e[1],s=e[2],o=e[3],a=Math.sin(r),c=Math.cos(r);return t[0]=n*c-s*a,t[1]=i*c+o*a,t[2]=s*c+n*a,t[3]=o*c-i*a,t}function b(t,e,r){r*=.5;const n=e[0],i=e[1],s=e[2],o=e[3],a=Math.sin(r),c=Math.cos(r);return t[0]=n*c+i*a,t[1]=i*c-n*a,t[2]=s*c+o*a,t[3]=o*c-s*a,t}function m(t,e){const r=e[0],n=e[1],i=e[2];return t[0]=r,t[1]=n,t[2]=i,t[3]=Math.sqrt(Math.abs(1-r*r-n*n-i*i)),t}function g(t,e,r,n){const i=e[0],s=e[1],a=e[2],c=e[3];let u,f,l,d,h,p=r[0],b=r[1],m=r[2],g=r[3];return f=i*p+s*b+a*m+c*g,f<0&&(f=-f,p=-p,b=-b,m=-m,g=-g),1-f>o["a"]?(u=Math.acos(f),l=Math.sin(u),d=Math.sin((1-n)*u)/l,h=Math.sin(n*u)/l):(d=1-n,h=n),t[0]=d*i+h*p,t[1]=d*s+h*b,t[2]=d*a+h*m,t[3]=d*c+h*g,t}function v(t){const e=Object(o["b"])(),r=Object(o["b"])(),n=Object(o["b"])(),i=Math.sqrt(1-e),s=Math.sqrt(e);return t[0]=i*Math.sin(2*Math.PI*r),t[1]=i*Math.cos(2*Math.PI*r),t[2]=s*Math.sin(2*Math.PI*n),t[3]=s*Math.cos(2*Math.PI*n),t}function y(t,e){const r=e[0],n=e[1],i=e[2],s=e[3],o=r*r+n*n+i*i+s*s,a=o?1/o:0;return t[0]=-r*a,t[1]=-n*a,t[2]=-i*a,t[3]=s*a,t}function _(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function O(t,e){const r=e[0]+e[4]+e[8];let n;if(r>0)n=Math.sqrt(r+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{let r=0;e[4]>e[0]&&(r=1),e[8]>e[3*r+r]&&(r=2);const i=(r+1)%3,s=(r+2)%3;n=Math.sqrt(e[3*r+r]-e[3*i+i]-e[3*s+s]+1),t[r]=.5*n,n=.5/n,t[3]=(e[3*i+s]-e[3*s+i])*n,t[i]=(e[3*i+r]+e[3*r+i])*n,t[s]=(e[3*s+r]+e[3*r+s])*n}return t}function x(t,e,r,n){const i=.5*Math.PI/180;e*=i,r*=i,n*=i;const s=Math.sin(e),o=Math.cos(e),a=Math.sin(r),c=Math.cos(r),u=Math.sin(n),f=Math.cos(n);return t[0]=s*c*f-o*a*u,t[1]=o*a*f+s*c*u,t[2]=o*c*u-s*a*f,t[3]=o*c*f+s*a*u,t}function T(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}const S=c["c"],w=c["l"],M=c["a"],j=d,A=c["b"],E=c["d"],P=c["j"],B=c["e"],I=B,F=c["f"],L=F,z=c["k"],C=c["g"],D=c["h"];function N(t,e,r){const n=Object(a["h"])(e,r);return n<-.999999?(Object(a["g"])(R,U,e),Object(a["y"])(R)<1e-6&&Object(a["g"])(R,V,e),Object(a["r"])(R,R),f(t,R,Math.PI),t):n>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(Object(a["g"])(R,e,r),t[0]=R[0],t[1]=R[1],t[2]=R[2],t[3]=1+n,z(t,t))}const R=Object(s["f"])(),U=Object(s["h"])(1,0,0),V=Object(s["h"])(0,1,0);function H(t,e,r,n,i,s){return g(k,e,i,s),g(W,r,n,s),g(t,k,W,2*s*(1-s)),t}const k=Object(i["b"])(),W=Object(i["b"])();function q(t,e,r,n){const i=G;return i[0]=r[0],i[3]=r[1],i[6]=r[2],i[1]=n[0],i[4]=n[1],i[7]=n[2],i[2]=-e[0],i[5]=-e[1],i[8]=-e[2],z(t,O(t,i))}const G=Object(n["b"])();Object.freeze({__proto__:null,identity:u,setAxisAngle:f,getAxisAngle:l,multiply:d,rotateX:h,rotateY:p,rotateZ:b,calculateW:m,slerp:g,random:v,invert:y,conjugate:_,fromMat3:O,fromEuler:x,str:T,copy:S,set:w,add:M,mul:j,scale:A,dot:E,lerp:P,length:B,len:I,squaredLength:F,sqrLen:L,normalize:z,exactEquals:C,equals:D,rotationTo:N,sqlerp:H,setAxes:q})},"0fc4":function(t,e,r){"use strict";function n(){return[0,0,0,0]}function i(t){return[t[0],t[1],t[2],t[3]]}function s(t,e,r,n){return[t,e,r,n]}function o(t){const e=n(),r=Math.min(4,t.length);for(let n=0;n<r;++n)e[n]=t[n];return e}function a(t,e){return new Float64Array(t,e,4)}function c(){return n()}function u(){return s(1,1,1,1)}function f(){return s(1,0,0,0)}function l(){return s(0,1,0,0)}function d(){return s(0,0,1,0)}function h(){return s(0,0,0,1)}r.d(e,"a",(function(){return b})),r.d(e,"b",(function(){return p})),r.d(e,"c",(function(){return a})),r.d(e,"d",(function(){return i})),r.d(e,"e",(function(){return n})),r.d(e,"f",(function(){return o})),r.d(e,"g",(function(){return s}));const p=c(),b=u(),m=f(),g=l(),v=d(),y=h();Object.freeze({__proto__:null,create:n,clone:i,fromValues:s,fromArray:o,createView:a,zeros:c,ones:u,unitX:f,unitY:l,unitZ:d,unitW:h,ZEROS:p,ONES:b,UNIT_X:m,UNIT_Y:g,UNIT_Z:v,UNIT_W:y})},1038:function(t,e,r){"use strict";r.d(e,"a",(function(){return g})),r.d(e,"b",(function(){return m})),r.d(e,"c",(function(){return b})),r.d(e,"d",(function(){return h})),r.d(e,"e",(function(){return p}));var n=r("e431"),i=r("0b2d"),s=r("2119"),o=(r("3349"),r("bd7e"));r("7361");function a(t,e,r){return Object(n["j"])(c,e,t),Object(n["j"])(u,r,t),Object(n["p"])(Object(n["g"])(c,c,u))/2}new s["a"](o["d"]),new s["a"](()=>({p0:null,p1:null,p2:null}));const c=Object(i["f"])(),u=Object(i["f"])();let f=(()=>{const t=new Uint32Array(131072);for(let e=0;e<t.length;++e)t[e]=e;return t})();const l=new Uint16Array([0]),d=(()=>{const t=new Uint16Array(65536);for(let e=0;e<t.length;++e)t[e]=e;return t})();function h(t){if(1===t)return l;if(t<d.length)return new Uint16Array(d.buffer,0,t);if(t>f.length){const e=Math.max(2*f.length,t);f=new Uint32Array(e);for(let t=0;t<f.length;t++)f[t]=t}return new Uint32Array(f.buffer,0,t)}function p(t){if(1===t)return new Uint16Array(l);if(t<d.length)return new Uint16Array(d.slice(0,t));if(t>f.length){const e=new Uint32Array(t);for(let t=0;t<e.length;t++)e[t]=t;return e}return new Uint32Array(f.slice(0,t))}function b(t,e,r){if(!t)return!1;const{size:i,data:s}=t;Object(n["w"])(r,0,0,0),Object(n["w"])(O,0,0,0);let o=0,c=0;for(let u=0;u<e.length-2;u+=3){const t=e[u+0]*i,f=e[u+1]*i,l=e[u+2]*i;Object(n["w"])(v,s[t+0],s[t+1],s[t+2]),Object(n["w"])(y,s[f+0],s[f+1],s[f+2]),Object(n["w"])(_,s[l+0],s[l+1],s[l+2]);const d=a(v,y,_);d?(Object(n["f"])(v,v,y),Object(n["f"])(v,v,_),Object(n["e"])(v,v,1/3*d),Object(n["f"])(r,r,v),o+=d):(Object(n["f"])(O,O,v),Object(n["f"])(O,O,y),Object(n["f"])(O,O,_),c+=3)}return(0!==c||0!==o)&&(0!==o?(Object(n["e"])(r,r,1/o),!0):0!==c&&(Object(n["e"])(r,O,1/c),!0))}function m(t,e,r){if(!t||!e)return!1;const{size:i,data:s}=t;Object(n["w"])(r,0,0,0);let o=-1,a=0;for(let n=0;n<e.length;n++){const t=e[n]*i;o!==t&&(r[0]+=s[t+0],r[1]+=s[t+1],r[2]+=s[t+2],a++),o=t}return a>1&&Object(n["e"])(r,r,1/a),a>0}function g(t,e,r,i){if(!t)return!1;const{size:s,data:o}=t;Object(n["w"])(i,0,0,0),Object(n["w"])(O,0,0,0);let a=0,c=0;const u=e?e.length-1:o.length/s-1,f=u+(r?2:0);for(let l=0;l<f;l+=2){const t=l<u?l:u,r=l<u?l+1:0,f=(e?e[t]:t)*s,d=(e?e[r]:r)*s;v[0]=o[f+0],v[1]=o[f+1],v[2]=o[f+2],y[0]=o[d+0],y[1]=o[d+1],y[2]=o[d+2],Object(n["e"])(v,Object(n["f"])(v,v,y),.5);const h=Object(n["n"])(v,y);h>0?(Object(n["f"])(i,i,Object(n["e"])(v,v,h)),a+=h):(Object(n["f"])(O,O,v),c++)}return 0!==a?(Object(n["e"])(i,i,1/a),!0):0!==c&&(Object(n["e"])(i,O,1/c),!0)}const v=Object(i["f"])(),y=Object(i["f"])(),_=Object(i["f"])(),O=Object(i["f"])()},1153:function(t,e,r){"use strict";r.d(e,"a",(function(){return o})),r.d(e,"b",(function(){return d})),r.d(e,"c",(function(){return h})),r.d(e,"d",(function(){return f})),r.d(e,"e",(function(){return l})),r.d(e,"f",(function(){return p})),r.d(e,"g",(function(){return u})),r.d(e,"h",(function(){return a})),r.d(e,"i",(function(){return c}));r("38a4"),r("d791");var n=r("3349"),i=(r("02f1"),r("0b2d"),r("7577"),r("0fc4"));Object(i["e"])();class s{constructor(t){this.message=t}toString(){return"AssertException: "+this.message}}function o(t,e){if(!t){e=e||"assert";const t=new Error(e);throw t.stack&&console.log(t.stack),new s(e)}}function a(t,e,r,n){let i,s=(r[0]-t[0])/e[0],o=(n[0]-t[0])/e[0];s>o&&(i=s,s=o,o=i);let a=(r[1]-t[1])/e[1],c=(n[1]-t[1])/e[1];if(a>c&&(i=a,a=c,c=i),s>c||a>o)return!1;a>s&&(s=a),c<o&&(o=c);let u=(r[2]-t[2])/e[2],f=(n[2]-t[2])/e[2];return u>f&&(i=u,u=f,f=i),!(s>f||u>o)&&(f<o&&(o=f),!(o<0))}function c(t,e,r,n){t[12]=e,t[13]=r,t[14]=n}function u(t){return 1===t[0]&&0===t[1]&&0===t[2]&&0===t[3]&&0===t[4]&&1===t[5]&&0===t[6]&&0===t[7]&&0===t[8]&&0===t[9]&&1===t[10]&&0===t[11]&&1===t[15]}function f(t,e,r){return 2*Math.atan(Math.sqrt(e*e+r*r)*Math.tan(.5*t)/e)}function l(t,e,r){return 2*Math.atan(Math.sqrt(e*e+r*r)*Math.tan(.5*t)/r)}function d(t,e,r){return 2*Math.atan(e*Math.tan(.5*t)/Math.sqrt(e*e+r*r))}function h(t,e,r){return 2*Math.atan(r*Math.tan(.5*t)/Math.sqrt(e*e+r*r))}function p(t,e,r,i,s){const o=t;0===t[11]?(i[0]=2/(e*o[0]),i[1]=2/(r*o[5]),i[2]=(1+o[12])/o[0],i[3]=(1+o[13])/o[5],Object(n["s"])(s,0,1)):(i[0]=-2/(e*o[0]),i[1]=-2/(r*o[5]),i[2]=(1-o[8])/o[0],i[3]=(1-o[9])/o[5],Object(n["s"])(s,1,0))}},"17b0":function(t,e,r){"use strict";r.d(e,"a",(function(){return s})),r.d(e,"b",(function(){return o}));var n=r("2f98"),i=r("3886");function s(t,e){const r=t.vertex.code;e.verticalOffsetEnabled?(t.vertex.uniforms.add("verticalOffset","vec4"),e.screenSizePerspectiveEnabled&&(t.include(n["a"]),t.vertex.uniforms.add("screenSizePerspectiveAlignment","vec4")),r.add(i["a"]`
    vec3 calculateVerticalOffset(vec3 worldPos, vec3 localOrigin) {
      float viewDistance = length((view * vec4(worldPos, 1.0)).xyz);
      ${1===e.viewingMode?i["a"]`vec3 worldNormal = normalize(worldPos + localOrigin);`:i["a"]`vec3 worldNormal = vec3(0.0, 0.0, 1.0);`}
      ${e.screenSizePerspectiveEnabled?i["a"]`
          float cosAngle = dot(worldNormal, normalize(worldPos - camPos));
          float verticalOffsetScreenHeight = screenSizePerspectiveScaleFloat(verticalOffset.x, abs(cosAngle), viewDistance, screenSizePerspectiveAlignment);`:i["a"]`
          float verticalOffsetScreenHeight = verticalOffset.x;`}
      // Screen sized offset in world space, used for example for line callouts
      float worldOffset = clamp(verticalOffsetScreenHeight * verticalOffset.y * viewDistance, verticalOffset.z, verticalOffset.w);
      return worldNormal * worldOffset;
    }

    vec3 addVerticalOffset(vec3 worldPos, vec3 localOrigin) {
      return worldPos + calculateVerticalOffset(worldPos, localOrigin);
    }
    `)):r.add(i["a"]`vec3 addVerticalOffset(vec3 worldPos, vec3 localOrigin) { return worldPos; }`)}function o(t,e,r){if(!e.verticalOffset)return;const n=a(e.verticalOffset,r.camera.fovY,r.camera.fullViewport[3]),i=r.camera.pixelRatio||1;t.setUniform4f("verticalOffset",n.screenLength*i,n.perDistance,n.minWorldLength,n.maxWorldLength)}function a(t,e,r,n=c){return n.screenLength=t.screenLength,n.perDistance=Math.tan(.5*e)/(.5*r),n.minWorldLength=t.minWorldLength,n.maxWorldLength=t.maxWorldLength,n}const c={screenLength:0,perDistance:0,minWorldLength:0,maxWorldLength:0}},"189c":function(t,e,r){"use strict";function n(t,e,r=32774,n=[0,0,0,0]){return{srcRgb:t,srcAlpha:t,dstRgb:e,dstAlpha:e,opRgb:r,opAlpha:r,color:{r:n[0],g:n[1],b:n[2],a:n[3]}}}function i(t,e,r,n,i=32774,s=32774,o=[0,0,0,0]){return{srcRgb:t,srcAlpha:e,dstRgb:r,dstAlpha:n,opRgb:i,opAlpha:s,color:{r:o[0],g:o[1],b:o[2],a:o[3]}}}r.d(e,"a",(function(){return R})),r.d(e,"b",(function(){return a})),r.d(e,"c",(function(){return u})),r.d(e,"d",(function(){return c})),r.d(e,"e",(function(){return o})),r.d(e,"f",(function(){return v})),r.d(e,"g",(function(){return i})),r.d(e,"h",(function(){return n}));const s={face:1029,mode:2305},o={face:1028,mode:2305},a=t=>2===t?s:1===t?o:null,c={zNear:0,zFar:1},u={r:!0,g:!0,b:!0,a:!0};function f(t){return O.intern(t)}function l(t){return T.intern(t)}function d(t){return w.intern(t)}function h(t){return j.intern(t)}function p(t){return E.intern(t)}function b(t){return B.intern(t)}function m(t){return F.intern(t)}function g(t){return z.intern(t)}function v(t){return D.intern(t)}class y{constructor(t,e){this.makeKey=t,this.makeRef=e,this.interns=new Map}intern(t){if(!t)return null;const e=this.makeKey(t),r=this.interns;return r.has(e)||r.set(e,this.makeRef(t)),r.get(e)}}function _(t){return"["+t.join(",")+"]"}const O=new y(x,t=>({__tag:"Blending",...t}));function x(t){return t?_([t.srcRgb,t.srcAlpha,t.dstRgb,t.dstAlpha,t.opRgb,t.opAlpha,t.color.r,t.color.g,t.color.b,t.color.a]):null}const T=new y(S,t=>({__tag:"Culling",...t}));function S(t){return t?_([t.face,t.mode]):null}const w=new y(M,t=>({__tag:"PolygonOffset",...t}));function M(t){return t?_([t.factor,t.units]):null}const j=new y(A,t=>({__tag:"DepthTest",...t}));function A(t){return t?_([t.func]):null}const E=new y(P,t=>({__tag:"StencilTest",...t}));function P(t){return t?_([t.function.func,t.function.ref,t.function.mask,t.operation.fail,t.operation.zFail,t.operation.zPass]):null}const B=new y(I,t=>({__tag:"DepthWrite",...t}));function I(t){return t?_([t.zNear,t.zFar]):null}const F=new y(L,t=>({__tag:"ColorWrite",...t}));function L(t){return t?_([t.r,t.g,t.b,t.a]):null}const z=new y(C,t=>({__tag:"StencilWrite",...t}));function C(t){return t?_([t.mask]):null}const D=new y(N,t=>({blending:f(t.blending),culling:l(t.culling),polygonOffset:d(t.polygonOffset),depthTest:h(t.depthTest),stencilTest:p(t.stencilTest),depthWrite:b(t.depthWrite),colorWrite:m(t.colorWrite),stencilWrite:g(t.stencilWrite)}));function N(t){return t?_([x(t.blending),S(t.culling),M(t.polygonOffset),A(t.depthTest),P(t.stencilTest),I(t.depthWrite),L(t.colorWrite),C(t.stencilWrite)]):null}class R{constructor(t){this._pipelineInvalid=!0,this._blendingInvalid=!0,this._cullingInvalid=!0,this._polygonOffsetInvalid=!0,this._depthTestInvalid=!0,this._stencilTestInvalid=!0,this._depthWriteInvalid=!0,this._colorWriteInvalid=!0,this._stencilWriteInvalid=!0,this._stateSetters=t}setPipeline(t){(this._pipelineInvalid||t!==this._pipeline)&&(this.setBlending(t.blending),this.setCulling(t.culling),this.setPolygonOffset(t.polygonOffset),this.setDepthTest(t.depthTest),this.setStencilTest(t.stencilTest),this.setDepthWrite(t.depthWrite),this.setColorWrite(t.colorWrite),this.setStencilWrite(t.stencilWrite),this._pipeline=t),this._pipelineInvalid=!1}invalidateBlending(){this._blendingInvalid=!0,this._pipelineInvalid=!0}invalidateCulling(){this._cullingInvalid=!0,this._pipelineInvalid=!0}invalidatePolygonOffset(){this._polygonOffsetInvalid=!0,this._pipelineInvalid=!0}invalidateDepthTest(){this._depthTestInvalid=!0,this._pipelineInvalid=!0}invalidateStencilTest(){this._stencilTestInvalid=!0,this._pipelineInvalid=!0}invalidateDepthWrite(){this._depthWriteInvalid=!0,this._pipelineInvalid=!0}invalidateColorWrite(){this._colorWriteInvalid=!0,this._pipelineInvalid=!0}invalidateStencilWrite(){this._stencilTestInvalid=!0,this._pipelineInvalid=!0}setBlending(t){this._blending=this.setSubState(t,this._blending,this._blendingInvalid,this._stateSetters.setBlending),this._blendingInvalid=!1}setCulling(t){this._culling=this.setSubState(t,this._culling,this._cullingInvalid,this._stateSetters.setCulling),this._cullingInvalid=!1}setPolygonOffset(t){this._polygonOffset=this.setSubState(t,this._polygonOffset,this._polygonOffsetInvalid,this._stateSetters.setPolygonOffset),this._polygonOffsetInvalid=!1}setDepthTest(t){this._depthTest=this.setSubState(t,this._depthTest,this._depthTestInvalid,this._stateSetters.setDepthTest),this._depthTestInvalid=!1}setStencilTest(t){this._stencilTest=this.setSubState(t,this._stencilTest,this._stencilTestInvalid,this._stateSetters.setStencilTest),this._stencilTestInvalid=!1}setDepthWrite(t){this._depthWrite=this.setSubState(t,this._depthWrite,this._depthWriteInvalid,this._stateSetters.setDepthWrite),this._depthWriteInvalid=!1}setColorWrite(t){this._colorWrite=this.setSubState(t,this._colorWrite,this._colorWriteInvalid,this._stateSetters.setColorWrite),this._colorWriteInvalid=!1}setStencilWrite(t){this._stencilWrite=this.setSubState(t,this._stencilWrite,this._stencilWriteInvalid,this._stateSetters.setStencilWrite),this._stencilTestInvalid=!1}setSubState(t,e,r,n){return(r||t!==e)&&(n(t),this._pipelineInvalid=!0),t}}},1956:function(t,e,r){"use strict";r.d(e,"a",(function(){return l})),r.d(e,"b",(function(){return u})),r.d(e,"c",(function(){return f}));var n=r("ce50"),i=r("c120"),s=r("e92d");const o=s["a"].getLogger("esri/views/webgl");function a(t,e){switch(e){case t.INVALID_ENUM:return"Invalid Enum. An unacceptable value has been specified for an enumerated argument.";case t.INVALID_VALUE:return"Invalid Value. A numeric argument is out of range.";case t.INVALID_OPERATION:return"Invalid Operation. The specified command is not allowed for the current state.";case t.INVALID_FRAMEBUFFER_OPERATION:return"Invalid Framebuffer operation. The currently bound framebuffer is not framebuffer complete when trying to render to or to read from it.";case t.OUT_OF_MEMORY:return"Out of memory. Not enough memory is left to execute the command.";case t.CONTEXT_LOST_WEBGL:return"WebGL context has been lost";default:return"Unknown error"}}const c=!!Object(i["a"])("enable-feature:webgl-debug");function u(){return c}function f(){return c}function l(t){if(u()){const e=t.getError();if(e){const r=a(t,e),i=(new Error).stack;o.error(new n["a"]("webgl-error","WebGL error occured",{message:r,stack:i}))}}}},"1e2c":function(t,e,r){"use strict";r.d(e,"a",(function(){return et}));var n=r("6c97"),i=r("ce50"),s=r("ce6d"),o=r("38a4"),a=r("b2b2"),c=r("f4cc"),u=r("a21b"),f=r("e041"),l=r("2db0"),d=r("228a"),h=r("b2cd");function p(){if(Object(a["k"])(b)){const t=t=>Object(h["a"])("esri/libs/basisu/"+t);b=r.e("chunk-5ba1e7e0").then(r.bind(null,"a58f")).then(t=>t.b).then(({default:e})=>e({locateFile:t}).then(t=>(t.initializeBasis(),delete t.then,t)))}return b}let b;var m=r("a1ff"),g=r("8539");let v=null,y=null;async function _(){return Object(a["k"])(y)&&(y=p(),v=await y),y}function O(t,e){if(Object(a["k"])(v))return t.byteLength;const r=new v.BasisFile(new Uint8Array(t)),n=S(r)?T(r.getNumLevels(0),r.getHasAlpha(),r.getImageWidth(0,0),r.getImageHeight(0,0),e):0;return r.close(),r.delete(),n}function x(t,e){if(Object(a["k"])(v))return t.byteLength;const r=new v.KTX2File(new Uint8Array(t)),n=w(r)?T(r.getLevels(),r.getHasAlpha(),r.getWidth(),r.getHeight(),e):0;return r.close(),r.delete(),n}function T(t,e,r,n,i){const s=Object(g["b"])(e?37496:37492),o=i&&t>1?(4**t-1)/(3*4**(t-1)):1;return Math.ceil(r*n*s*o)}function S(t){return t.getNumImages()>=1&&!t.isUASTC()}function w(t){return t.getFaces()>=1&&t.isETC1S()}async function M(t,e,r){Object(a["k"])(v)&&(v=await _());const n=new v.BasisFile(new Uint8Array(r));if(!S(n))return null;n.startTranscoding();const i=A(t,e,n.getNumLevels(0),n.getHasAlpha(),n.getImageWidth(0,0),n.getImageHeight(0,0),(t,e)=>n.getImageTranscodedSizeInBytes(0,t,e),(t,e,r)=>n.transcodeImage(r,0,t,e,0,0));return n.close(),n.delete(),i}async function j(t,e,r){Object(a["k"])(v)&&(v=await _());const n=new v.KTX2File(new Uint8Array(r));if(!w(n))return null;n.startTranscoding();const i=A(t,e,n.getLevels(),n.getHasAlpha(),n.getWidth(),n.getHeight(),(t,e)=>n.getImageTranscodedSizeInBytes(t,0,0,e),(t,e,r)=>n.transcodeImage(r,t,0,0,e,0,-1,-1));return n.close(),n.delete(),i}function A(t,e,r,n,i,s,o,a){const{compressedTextureETC:c,compressedTextureS3TC:u}=t.capabilities,[f,l]=c?n?[1,37496]:[0,37492]:u?n?[3,33779]:[2,33776]:[13,6408],d=e.hasMipmap?r:Math.min(1,r),h=[];for(let m=0;m<d;m++)h.push(new Uint8Array(o(m,f))),a(m,f,h[m]);const p=h.length>1,b=p?9987:9729,g={...e,samplingMode:b,hasMipmap:p,internalFormat:l,width:i,height:s};return new m["a"](t,g,{type:"compressed",levels:h})}var E=r("003f"),P=r("e92d");const B=P["a"].getLogger("esri.views.3d.webgl-engine.lib.DDSUtil"),I=542327876,F=131072,L=4;function z(t){return t.charCodeAt(0)+(t.charCodeAt(1)<<8)+(t.charCodeAt(2)<<16)+(t.charCodeAt(3)<<24)}function C(t){return String.fromCharCode(255&t,t>>8&255,t>>16&255,t>>24&255)}const D=z("DXT1"),N=z("DXT3"),R=z("DXT5"),U=31,V=0,H=1,k=2,W=3,q=4,G=7,$=20,Y=21;function X(t,e,r){const{textureData:n,internalFormat:i,width:s,height:o}=K(r,e.hasMipmap);return e.samplingMode=n.levels.length>1?9987:9729,e.hasMipmap=n.levels.length>1,e.internalFormat=i,e.width=s,e.height=o,new m["a"](t,e,n)}function K(t,e){const r=new Int32Array(t,0,U);if(r[V]!==I)return B.error("Invalid magic number in DDS header"),null;if(!(r[$]&L))return B.error("Unsupported format, must contain a FourCC code"),null;const n=r[Y];let i,s;switch(n){case D:i=8,s=33776;break;case N:i=16,s=33778;break;case R:i=16,s=33779;break;default:return B.error("Unsupported FourCC code:",C(n)),null}let a=1,c=r[q],u=r[W];0==(3&c)&&0==(3&u)||(B.warn("Rounding up compressed texture size to nearest multiple of 4."),c=c+3&-4,u=u+3&-4);const f=c,l=u;let d,h;r[k]&F&&!1!==e&&(a=Math.max(1,r[G])),1===a||Object(o["h"])(c)&&Object(o["h"])(u)||(B.warn("Ignoring mipmaps of non power of two sized compressed texture."),a=1);let p=r[H]+4;const b=[];for(let o=0;o<a;++o)h=(c+3>>2)*(u+3>>2)*i,d=new Uint8Array(t,p,h),b.push(d),p+=h,c=Math.max(1,c>>1),u=Math.max(1,u>>1);return{textureData:{type:"compressed",levels:b},internalFormat:s,width:f,height:l}}var Z=r("d5f7"),J=r("1153"),Q=r("d267"),tt=r("c514");class et extends E["a"]{constructor(t,e){super(),this.data=t,this.type=4,this._glTexture=null,this._powerOfTwoStretchInfo=null,this._loadingPromise=null,this._loadingController=null,this.events=new s["a"],this.params=e||{},this.params.mipmap=!1!==this.params.mipmap,this.params.noUnpackFlip=this.params.noUnpackFlip||!1,this.params.preMultiplyAlpha=this.params.preMultiplyAlpha||!1,this.params.wrap=this.params.wrap||{s:10497,t:10497},this.params.powerOfTwoResizeMode=this.params.powerOfTwoResizeMode||1,this.estimatedTexMemRequired=et.estimateTexMemRequired(this.data,this.params),this.startPreload()}startPreload(){const t=this.data;Object(a["k"])(t)||(t instanceof HTMLVideoElement?this.startPreloadVideoElement(t):t instanceof HTMLImageElement&&this.startPreloadImageElement(t))}startPreloadVideoElement(t){Object(f["t"])(t.src)||"auto"===t.preload&&t.crossOrigin||(t.preload="auto",t.crossOrigin="anonymous",t.src=t.src)}startPreloadImageElement(t){Object(f["u"])(t.src)||Object(f["t"])(t.src)||t.crossOrigin||(t.crossOrigin="anonymous",t.src=t.src)}static getDataDimensions(t){return t instanceof HTMLVideoElement?{width:t.videoWidth,height:t.videoHeight}:t}static estimateTexMemRequired(t,e){if(Object(a["k"])(t))return 0;if(Object(u["c"])(t)||Object(u["k"])(t))return e.encoding===et.KTX2_ENCODING?x(t,e.mipmap):e.encoding===et.BASIS_ENCODING?O(t,e.mipmap):t.byteLength;const{width:r,height:n}=t instanceof Image||t instanceof ImageData||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement?et.getDataDimensions(t):e;return(e.mipmap?4/3:1)*r*n*(e.components||4)||0}dispose(){this.data=void 0}get width(){return this.params.width}get height(){return this.params.height}createDescriptor(t){var e;return{target:3553,pixelFormat:6408,dataType:5121,wrapMode:this.params.wrap,flipped:!this.params.noUnpackFlip,samplingMode:this.params.mipmap?9987:9729,hasMipmap:this.params.mipmap,preMultiplyAlpha:this.params.preMultiplyAlpha,maxAnisotropy:null!=(e=this.params.maxAnisotropy)?e:this.params.mipmap?t.parameters.maxMaxAnisotropy:1}}get glTexture(){return this._glTexture}load(t,e){if(Object(a["l"])(this._glTexture))return this._glTexture;if(Object(a["l"])(this._loadingPromise))return this._loadingPromise;const r=this.data;return Object(a["k"])(r)?(this._glTexture=new m["a"](t,this.createDescriptor(t),null),this._glTexture):"string"==typeof r?this.loadFromURL(t,e,r):r instanceof Image?this.loadFromImageElement(t,e,r):r instanceof HTMLVideoElement?this.loadFromVideoElement(t,e,r):r instanceof ImageData||r instanceof HTMLCanvasElement?this.loadFromImage(t,r,e):(Object(u["c"])(r)||Object(u["k"])(r))&&this.params.encoding===et.DDS_ENCODING?this.loadFromDDSData(t,r):(Object(u["c"])(r)||Object(u["k"])(r))&&this.params.encoding===et.KTX2_ENCODING?this.loadFromKTX2(t,r):(Object(u["c"])(r)||Object(u["k"])(r))&&this.params.encoding===et.BASIS_ENCODING?this.loadFromBasis(t,r):Object(u["k"])(r)?this.loadFromPixelData(t,r):Object(u["c"])(r)?this.loadFromPixelData(t,new Uint8Array(r)):null}get requiresFrameUpdates(){return this.data instanceof HTMLVideoElement}frameUpdate(t,e,r){if(!(this.data instanceof HTMLVideoElement)||Object(a["k"])(this._glTexture))return r;if(this.data.readyState<2||r===this.data.currentTime)return r;if(Object(a["l"])(this._powerOfTwoStretchInfo)){const{framebuffer:r,vao:n,sourceTexture:i}=this._powerOfTwoStretchInfo;i.setData(this.data),this.drawStretchedTexture(t,e,r,n,i,this._glTexture)}else{const{width:t,height:e}=this.data,{width:r,height:n}=this._glTexture.descriptor;t!==r||e!==n?this._glTexture.updateData(0,0,0,Math.min(t,r),Math.min(e,n),this.data):this._glTexture.setData(this.data)}return this._glTexture.descriptor.hasMipmap&&this._glTexture.generateMipmap(),this.data.currentTime}loadFromDDSData(t,e){return this._glTexture=X(t,this.createDescriptor(t),e),this._glTexture}loadFromKTX2(t,e){return this.loadAsync(()=>j(t,this.createDescriptor(t),e).then(t=>(this._glTexture=t,t)))}loadFromBasis(t,e){return this.loadAsync(()=>M(t,this.createDescriptor(t),e).then(t=>(this._glTexture=t,t)))}loadFromPixelData(t,e){Object(J["a"])(this.params.width>0&&this.params.height>0);const r=this.createDescriptor(t);return r.pixelFormat=1===this.params.components?6409:3===this.params.components?6407:6408,r.width=this.params.width,r.height=this.params.height,this._glTexture=new m["a"](t,r,e),this._glTexture}loadFromURL(t,e,r){return this.loadAsync(async n=>{const i=await Object(l["a"])(r,{signal:n});return this.loadFromImage(t,i,e)})}loadFromImageElement(t,e,r){return r.complete?this.loadFromImage(t,r,e):this.loadAsync(async n=>{const i=await Object(d["a"])(r,r.src,!1,n);return this.loadFromImage(t,i,e)})}loadFromVideoElement(t,e,r){return r.readyState>=2?this.loadFromImage(t,r,e):this.loadFromVideoElementAsync(t,e,r)}loadFromVideoElementAsync(t,e,r){return this.loadAsync(n=>new Promise((s,o)=>{const u=()=>{r.removeEventListener("loadeddata",f),r.removeEventListener("error",l),Object(a["s"])(d)},f=()=>{r.readyState>=2&&(u(),s(this.loadFromImage(t,r,e)))},l=t=>{u(),o(t||new i["a"]("Failed to load video"))};r.addEventListener("loadeddata",f),r.addEventListener("error",l);const d=Object(c["p"])(n,()=>l(Object(c["d"])()))}))}loadFromImage(t,e,r){const n=et.getDataDimensions(e);this.params.width=n.width,this.params.height=n.height;const i=this.createDescriptor(t);return i.pixelFormat=3===this.params.components?6407:6408,!this.requiresPowerOfTwo(t,i)||Object(o["h"])(n.width)&&Object(o["h"])(n.height)?(i.width=n.width,i.height=n.height,this._glTexture=new m["a"](t,i,e),this._glTexture):(this._glTexture=this.makePowerOfTwoTexture(t,e,n,i,r),this._glTexture)}loadAsync(t){const e=new AbortController;this._loadingController=e;const r=t(e.signal);this._loadingPromise=r;const n=()=>{this._loadingController===e&&(this._loadingController=null),this._loadingPromise===r&&(this._loadingPromise=null)};return r.then(n,n),r}requiresPowerOfTwo(t,e){const r=33071,n="number"==typeof e.wrapMode?e.wrapMode===r:e.wrapMode.s===r&&e.wrapMode.t===r;return!Object(tt["a"])(t.gl)&&(e.hasMipmap||!n)}makePowerOfTwoTexture(t,e,r,i,s){const{width:a,height:c}=r,u=Object(o["j"])(a),f=Object(o["j"])(c);let l;switch(i.width=u,i.height=f,this.params.powerOfTwoResizeMode){case 2:i.textureCoordinateScaleFactor=[a/u,c/f],l=new m["a"](t,i),l.updateData(0,0,0,a,c,e);break;case 1:case null:case void 0:l=this.stretchToPowerOfTwo(t,e,i,s());break;default:Object(n["a"])(this.params.powerOfTwoResizeMode)}return i.hasMipmap&&l.generateMipmap(),l}stretchToPowerOfTwo(t,e,r,n){const i=new m["a"](t,r),s=new Q["a"](t,{colorTarget:0,depthStencilTarget:0},i),o=new m["a"](t,{target:3553,pixelFormat:r.pixelFormat,dataType:5121,wrapMode:33071,samplingMode:9729,flipped:!!r.flipped,maxAnisotropy:8,preMultiplyAlpha:r.preMultiplyAlpha},e),a=Object(Z["b"])(t),c=t.getBoundFramebufferObject();return this.drawStretchedTexture(t,n,s,a,o,i),this.requiresFrameUpdates?this._powerOfTwoStretchInfo={vao:a,sourceTexture:o,framebuffer:s}:(a.dispose(!0),o.dispose(),s.detachColorTexture(),s.dispose()),t.bindFramebuffer(c),i}drawStretchedTexture(t,e,r,n,i,s){t.bindFramebuffer(r);const o=t.getViewport();t.setViewport(0,0,s.descriptor.width,s.descriptor.height);const a=e.program;t.useProgram(a),a.setUniform4f("color",1,1,1,1),a.bindTexture(i,"tex"),t.bindVAO(n),e.bindPipelineState(t),t.drawArrays(5,0,Object(g["e"])(n,"geometry")),t.bindFramebuffer(null),t.setViewport(o.x,o.y,o.width,o.height)}unload(){if(Object(a["l"])(this._powerOfTwoStretchInfo)){const{framebuffer:t,vao:e,sourceTexture:r}=this._powerOfTwoStretchInfo;e.dispose(!0),r.dispose(),t.dispose(),this._glTexture=null,this._powerOfTwoStretchInfo=null}if(Object(a["l"])(this._glTexture)&&(this._glTexture.dispose(),this._glTexture=null),Object(a["l"])(this._loadingController)){const t=this._loadingController;this._loadingController=null,this._loadingPromise=null,t.abort()}this.events.emit("unloaded")}}et.DDS_ENCODING="image/vnd-ms.dds",et.KTX2_ENCODING="image/ktx2",et.BASIS_ENCODING="image/x.basis"},2119:function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=r("2ab7");class i{constructor(t){this.allocator=t,this._items=[],this._itemsPtr=0,this.grow()}get(){return 0===this._itemsPtr&&Object(n["a"])(()=>this.reset()),this._itemsPtr===this._items.length&&this.grow(),this._items[this._itemsPtr++]}reset(){const t=Math.min(3*Math.max(8,this._itemsPtr),this._itemsPtr+3*s);this._items.length=Math.min(t,this._items.length),this._itemsPtr=0}grow(){for(let t=0;t<Math.max(8,Math.min(this._items.length,s));t++)this._items.push(this.allocator())}}const s=1024},"2db0":function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=r("2eab");async function i(t,e){const{data:r}=await Object(n["default"])(t,{responseType:"image",...e});return r}},"2f98":function(t,e,r){"use strict";r.d(e,"a",(function(){return s})),r.d(e,"b",(function(){return o}));var n=r("3886"),i=r("7c51");function s(t){t.vertex.code.add(n["a"]`float screenSizePerspectiveMinSize(float size, vec4 factor) {
float nonZeroSize = 1.0 - step(size, 0.0);
return (
factor.z * (
1.0 +
nonZeroSize *
2.0 * factor.w / (
size + (1.0 - nonZeroSize)
)
)
);
}`),t.vertex.code.add(n["a"]`float screenSizePerspectiveViewAngleDependentFactor(float absCosAngle) {
return absCosAngle * absCosAngle * absCosAngle;
}`),t.vertex.code.add(n["a"]`vec4 screenSizePerspectiveScaleFactor(float absCosAngle, float distanceToCamera, vec4 params) {
return vec4(
min(params.x / (distanceToCamera - params.y), 1.0),
screenSizePerspectiveViewAngleDependentFactor(absCosAngle),
params.z,
params.w
);
}`),t.vertex.code.add(n["a"]`float applyScreenSizePerspectiveScaleFactorFloat(float size, vec4 factor) {
return max(mix(size * factor.x, size, factor.y), screenSizePerspectiveMinSize(size, factor));
}`),t.vertex.code.add(n["a"]`float screenSizePerspectiveScaleFloat(float size, float absCosAngle, float distanceToCamera, vec4 params) {
return applyScreenSizePerspectiveScaleFactorFloat(
size,
screenSizePerspectiveScaleFactor(absCosAngle, distanceToCamera, params)
);
}`),t.vertex.code.add(n["a"]`vec2 applyScreenSizePerspectiveScaleFactorVec2(vec2 size, vec4 factor) {
return mix(size * clamp(factor.x, screenSizePerspectiveMinSize(size.y, factor) / size.y, 1.0), size, factor.y);
}`),t.vertex.code.add(n["a"]`vec2 screenSizePerspectiveScaleVec2(vec2 size, float absCosAngle, float distanceToCamera, vec4 params) {
return applyScreenSizePerspectiveScaleFactorVec2(size, screenSizePerspectiveScaleFactor(absCosAngle, distanceToCamera, params));
}`)}function o(t,e){if(e.screenSizePerspective){Object(i["a"])(e.screenSizePerspective,t,"screenSizePerspective");const r=e.screenSizePerspectiveAlignment||e.screenSizePerspective;Object(i["a"])(r,t,"screenSizePerspectiveAlignment")}}},"35b3":function(t,e,r){"use strict";r.d(e,"a",(function(){return a})),r.d(e,"b",(function(){return c}));var n=r("b2b2"),i=r("003f"),s=r("fa1e"),o=r("7c51");class a extends i["a"]{constructor(t,e){super(),this.type=3,this.supportsEdges=!1,this._visible=!0,this._renderPriority=0,this._insertOrder=0,this._vertexAttributeLocations=s["a"],this._parameters=Object(o["c"])(t,e),this.validateParameters(this._parameters)}dispose(){}get parameters(){return this._parameters}update(t){return!1}setParameters(t){Object(o["h"])(this._parameters,t)&&(this.validateParameters(this._parameters),this.parametersChanged())}validateParameters(t){}get visible(){return this._visible}set visible(t){t!==this._visible&&(this._visible=t,this.parametersChanged())}shouldRender(t){return this.isVisible()&&this.isVisibleInPass(t.pass)&&0!=(this.renderOccluded&t.renderOccludedMask)}isVisibleInPass(t){return!0}get renderOccluded(){return this.parameters.renderOccluded}get renderPriority(){return this._renderPriority}set renderPriority(t){t!==this._renderPriority&&(this._renderPriority=t,this.parametersChanged())}get insertOrder(){return this._insertOrder}set insertOrder(t){t!==this._insertOrder&&(this._insertOrder=t,this.parametersChanged())}get vertexAttributeLocations(){return this._vertexAttributeLocations}isVisible(){return this._visible}parametersChanged(){Object(n["l"])(this.repository)&&this.repository.materialChanged(this)}}const c={renderOccluded:1}},3886:function(t,e,r){"use strict";function n(t,...e){let r="";for(let n=0;n<e.length;n++)r+=t[n]+e[n];return r+=t[t.length-1],r}r.d(e,"a",(function(){return n})),function(t){function e(t){return Math.round(t).toString()}function r(t){return t.toPrecision(8)}t.int=e,t.float=r}(n||(n={}))},4377:function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=r("3886");function i(t){t.code.add(n["a"]`vec4 premultiplyAlpha(vec4 v) {
return vec4(v.rgb * v.a, v.a);
}
vec3 rgb2hsv(vec3 c) {
vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);
vec4 p = c.g < c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);
vec4 q = c.r < p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);
float d = q.x - min(q.w, q.y);
float e = 1.0e-10;
return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), min(d / (q.x + e), 1.0), q.x);
}
vec3 hsv2rgb(vec3 c) {
vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);
vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);
return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);
}
float rgb2v(vec3 c) {
return max(c.x, max(c.y, c.z));
}`)}},"47f8":function(t,e,r){"use strict";function n(){return new Float32Array(3)}function i(t){const e=new Float32Array(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function s(t,e,r){const n=new Float32Array(3);return n[0]=t,n[1]=e,n[2]=r,n}function o(t,e){return new Float32Array(t,e,3)}function a(){return n()}function c(){return s(1,1,1)}function u(){return s(1,0,0)}function f(){return s(0,1,0)}function l(){return s(0,0,1)}r.d(e,"a",(function(){return i})),r.d(e,"b",(function(){return n})),r.d(e,"c",(function(){return s}));const d=a(),h=c(),p=u(),b=f(),m=l();Object.freeze({__proto__:null,create:n,clone:i,fromValues:s,createView:o,zeros:a,ones:c,unitX:u,unitY:f,unitZ:l,ZEROS:d,ONES:h,UNIT_X:p,UNIT_Y:b,UNIT_Z:m})},"4db9":function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=r("3886");function i(t,e){e.linearDepth?t.vertex.code.add(n["a"]`vec4 transformPositionWithDepth(mat4 proj, mat4 view, vec3 pos, vec2 nearFar, out float depth) {
vec4 eye = view * vec4(pos, 1.0);
depth = (-eye.z - nearFar[0]) / (nearFar[1] - nearFar[0]) ;
return proj * eye;
}`):t.vertex.code.add(n["a"]`vec4 transformPosition(mat4 proj, mat4 view, vec3 pos) {
return proj * (view * vec4(pos, 1.0));
}`)}},"501b":function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=r("3886");function i(t){t.code.add(n["a"]`const float MAX_RGBA_FLOAT =
255.0 / 256.0 +
255.0 / 256.0 / 256.0 +
255.0 / 256.0 / 256.0 / 256.0 +
255.0 / 256.0 / 256.0 / 256.0 / 256.0;
const vec4 FIXED_POINT_FACTORS = vec4(1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0);
vec4 float2rgba(const float value) {
float valueInValidDomain = clamp(value, 0.0, MAX_RGBA_FLOAT);
vec4 fixedPointU8 = floor(fract(valueInValidDomain * FIXED_POINT_FACTORS) * 256.0);
const float toU8AsFloat = 1.0 / 255.0;
return fixedPointU8 * toU8AsFloat;
}
const vec4 RGBA_2_FLOAT_FACTORS = vec4(
255.0 / (256.0),
255.0 / (256.0 * 256.0),
255.0 / (256.0 * 256.0 * 256.0),
255.0 / (256.0 * 256.0 * 256.0 * 256.0)
);
float rgba2float(vec4 rgba) {
return dot(rgba, RGBA_2_FLOAT_FACTORS);
}`)}},5957:function(t,e,r){"use strict";r.d(e,"a",(function(){return c})),r.d(e,"b",(function(){return d})),r.d(e,"c",(function(){return h})),r.d(e,"d",(function(){return f})),r.d(e,"e",(function(){return u}));var n=r("d791"),i=r("8190"),s=r("1153");function o(t,e,r,n){const i=r.typedBuffer,s=r.typedBufferStride,o=t.length;n*=s;for(let a=0;a<o;++a){const r=2*t[a];i[n]=e[r],i[n+1]=e[r+1],n+=s}}function a(t,e,r,n,i){const s=r.typedBuffer,o=r.typedBufferStride,a=t.length;if(n*=o,null==i||1===i)for(let c=0;c<a;++c){const r=3*t[c];s[n]=e[r],s[n+1]=e[r+1],s[n+2]=e[r+2],n+=o}else for(let c=0;c<a;++c){const r=3*t[c];for(let t=0;t<i;++t)s[n]=e[r],s[n+1]=e[r+1],s[n+2]=e[r+2],n+=o}}function c(t,e,r,n,i=1){const s=r.typedBuffer,o=r.typedBufferStride,a=t.length;if(n*=o,1===i)for(let c=0;c<a;++c){const r=4*t[c];s[n]=e[r],s[n+1]=e[r+1],s[n+2]=e[r+2],s[n+3]=e[r+3],n+=o}else for(let c=0;c<a;++c){const r=4*t[c];for(let t=0;t<i;++t)s[n]=e[r],s[n+1]=e[r+1],s[n+2]=e[r+2],s[n+3]=e[r+3],n+=o}}function u(t,e,r,n,i,s=1){if(!r)return void a(t,e,n,i,s);const o=n.typedBuffer,c=n.typedBufferStride,u=t.length,f=r[0],l=r[1],d=r[2],h=r[4],p=r[5],b=r[6],m=r[8],g=r[9],v=r[10],y=r[12],_=r[13],O=r[14];if(i*=c,1===s)for(let a=0;a<u;++a){const r=3*t[a],n=e[r],s=e[r+1],u=e[r+2];o[i]=f*n+h*s+m*u+y,o[i+1]=l*n+p*s+g*u+_,o[i+2]=d*n+b*s+v*u+O,i+=c}else for(let a=0;a<u;++a){const r=3*t[a],n=e[r],u=e[r+1],x=e[r+2],T=f*n+h*u+m*x+y,S=l*n+p*u+g*x+_,w=d*n+b*u+v*x+O;for(let t=0;t<s;++t)o[i]=T,o[i+1]=S,o[i+2]=w,i+=c}}function f(t,e,r,i,s,o=1){if(!r)return void a(t,e,i,s,o);const c=r,u=i.typedBuffer,f=i.typedBufferStride,l=t.length,d=c[0],h=c[1],p=c[2],b=c[4],m=c[5],g=c[6],v=c[8],y=c[9],_=c[10],O=!Object(n["l"])(c),x=1e-6,T=1-x;if(s*=f,1===o)for(let n=0;n<l;++n){const r=3*t[n],i=e[r],o=e[r+1],a=e[r+2];let c=d*i+b*o+v*a,l=h*i+m*o+y*a,S=p*i+g*o+_*a;if(O){const t=c*c+l*l+S*S;if(t<T&&t>x){const e=1/Math.sqrt(t);c*=e,l*=e,S*=e}}u[s+0]=c,u[s+1]=l,u[s+2]=S,s+=f}else for(let n=0;n<l;++n){const r=3*t[n],i=e[r],a=e[r+1],c=e[r+2];let l=d*i+b*a+v*c,S=h*i+m*a+y*c,w=p*i+g*a+_*c;if(O){const t=l*l+S*S+w*w;if(t<T&&t>x){const e=1/Math.sqrt(t);l*=e,S*=e,w*=e}}for(let t=0;t<o;++t)u[s+0]=l,u[s+1]=S,u[s+2]=w,s+=f}}function l(t,e,r,i,s,o=1){if(!r)return void c(t,e,i,s,o);const a=r,u=i.typedBuffer,f=i.typedBufferStride,l=t.length,d=a[0],h=a[1],p=a[2],b=a[4],m=a[5],g=a[6],v=a[8],y=a[9],_=a[10],O=!Object(n["l"])(a),x=1e-6,T=1-x;if(s*=f,1===o)for(let n=0;n<l;++n){const r=4*t[n],i=e[r],o=e[r+1],a=e[r+2],c=e[r+3];let l=d*i+b*o+v*a,S=h*i+m*o+y*a,w=p*i+g*o+_*a;if(O){const t=l*l+S*S+w*w;if(t<T&&t>x){const e=1/Math.sqrt(t);l*=e,S*=e,w*=e}}u[s+0]=l,u[s+1]=S,u[s+2]=w,u[s+3]=c,s+=f}else for(let n=0;n<l;++n){const r=4*t[n],i=e[r],a=e[r+1],c=e[r+2],l=e[r+3];let S=d*i+b*a+v*c,w=h*i+m*a+y*c,M=p*i+g*a+_*c;if(O){const t=S*S+w*w+M*M;if(t<T&&t>x){const e=1/Math.sqrt(t);S*=e,w*=e,M*=e}}for(let t=0;t<o;++t)u[s+0]=S,u[s+1]=w,u[s+2]=M,u[s+3]=l,s+=f}}function d(t,e,r,n,i,s=1){const o=n.typedBuffer,a=n.typedBufferStride,c=t.length;if(i*=a,1===s){if(4===r)for(let u=0;u<c;++u){const r=4*t[u];o[i]=e[r],o[i+1]=e[r+1],o[i+2]=e[r+2],o[i+3]=e[r+3],i+=a}else if(3===r)for(let u=0;u<c;++u){const r=3*t[u];o[i]=e[r],o[i+1]=e[r+1],o[i+2]=e[r+2],o[i+3]=255,i+=a}}else if(4===r)for(let u=0;u<c;++u){const r=4*t[u];for(let t=0;t<s;++t)o[i]=e[r],o[i+1]=e[r+1],o[i+2]=e[r+2],o[i+3]=e[r+3],i+=a}else if(3===r)for(let u=0;u<c;++u){const r=3*t[u];for(let t=0;t<s;++t)o[i]=e[r],o[i+1]=e[r+1],o[i+2]=e[r+2],o[i+3]=255,i+=a}}function h(t,e,r,n,a,c){for(const h of e.fieldNames){const e=t.vertexAttributes.get(h),p=t.indices.get(h);if(e&&p)switch(h){case"position":{Object(s["a"])(3===e.size);const t=a.getField(h,i["u"]);t&&u(p,e.data,r,t,c);break}case"normal":{Object(s["a"])(3===e.size);const t=a.getField(h,i["u"]);t&&f(p,e.data,n,t,c);break}case"uv0":{Object(s["a"])(2===e.size);const t=a.getField(h,i["m"]);t&&o(p,e.data,t,c);break}case"color":{Object(s["a"])(3===e.size||4===e.size);const t=a.getField(h,i["J"]);t&&d(p,e.data,e.size,t,c);break}case"symbolColor":{Object(s["a"])(3===e.size||4===e.size);const t=a.getField(h,i["J"]);t&&d(p,e.data,e.size,t,c);break}case"tangent":{Object(s["a"])(4===e.size);const t=a.getField(h,i["C"]);t&&l(p,e.data,n,t,c);break}}}}},"5d5f":function(t,e,r){"use strict";r.d(e,"a",(function(){return o}));var n=r("3886");function i(t){const e=t.fragment.code;e.add(n["a"]`vec3 evaluateDiffuseIlluminationHemisphere(vec3 ambientGround, vec3 ambientSky, float NdotNG)
{
return ((1.0 - NdotNG) * ambientGround + (1.0 + NdotNG) * ambientSky) * 0.5;
}`),e.add(n["a"]`float integratedRadiance(float cosTheta2, float roughness)
{
return (cosTheta2 - 1.0) / (cosTheta2 * (1.0 - roughness * roughness) - 1.0);
}`),e.add(n["a"]`vec3 evaluateSpecularIlluminationHemisphere(vec3 ambientGround, vec3 ambientSky, float RdotNG, float roughness)
{
float cosTheta2 = 1.0 - RdotNG * RdotNG;
float intRadTheta = integratedRadiance(cosTheta2, roughness);
float ground = RdotNG < 0.0 ? 1.0 - intRadTheta : 1.0 + intRadTheta;
float sky = 2.0 - ground;
return (ground * ambientGround + sky * ambientSky) * 0.5;
}`)}var s=r("c51b");function o(t,e){const r=t.fragment.code;t.include(s["a"]),3===e.pbrMode||4===e.pbrMode?(r.add(n["a"]`
    struct PBRShadingWater
    {
        float NdotL;   // cos angle between normal and light direction
        float NdotV;   // cos angle between normal and view direction
        float NdotH;   // cos angle between normal and half vector
        float VdotH;   // cos angle between view direction and half vector
        float LdotH;   // cos angle between light direction and half vector
        float VdotN;   // cos angle between view direction and normal vector
    };

    float dtrExponent = ${e.useCustomDTRExponentForWater?"2.2":"2.0"};
    `),r.add(n["a"]`vec3 fresnelReflection(float angle, vec3 f0, float f90) {
return f0 + (f90 - f0) * pow(1.0 - angle, 5.0);
}`),r.add(n["a"]`float normalDistributionWater(float NdotH, float roughness)
{
float r2 = roughness * roughness;
float NdotH2 = NdotH * NdotH;
float denom = pow((NdotH2 * (r2 - 1.0) + 1.0), dtrExponent) * PI;
return r2 / denom;
}`),r.add(n["a"]`float geometricOcclusionKelemen(float LoH)
{
return 0.25 / (LoH * LoH);
}`),r.add(n["a"]`vec3 brdfSpecularWater(in PBRShadingWater props, float roughness, vec3 F0, float F0Max)
{
vec3  F = fresnelReflection(props.VdotH, F0, F0Max);
float dSun = normalDistributionWater(props.NdotH, roughness);
float V = geometricOcclusionKelemen(props.LdotH);
float diffusionSunHaze = mix(roughness + 0.045, roughness + 0.385, 1.0 - props.VdotH);
float strengthSunHaze  = 1.2;
float dSunHaze = normalDistributionWater(props.NdotH, diffusionSunHaze)*strengthSunHaze;
return ((dSun + dSunHaze) * V) * F;
}
vec3 tonemapACES(const vec3 x) {
return (x * (2.51 * x + 0.03)) / (x * (2.43 * x + 0.59) + 0.14);
}`)):1!==e.pbrMode&&2!==e.pbrMode||(t.include(i),r.add(n["a"]`struct PBRShadingInfo
{
float NdotL;
float NdotV;
float NdotH;
float VdotH;
float LdotH;
float NdotNG;
float RdotNG;
float NdotAmbDir;
float NdotH_Horizon;
vec3 skyRadianceToSurface;
vec3 groundRadianceToSurface;
vec3 skyIrradianceToSurface;
vec3 groundIrradianceToSurface;
float averageAmbientRadiance;
float ssao;
vec3 albedoLinear;
vec3 f0;
vec3 f90;
vec3 diffuseColor;
float metalness;
float roughness;
};`),r.add(n["a"]`float normalDistribution(float NdotH, float roughness)
{
float a = NdotH * roughness;
float b = roughness / (1.0 - NdotH * NdotH + a * a);
return b * b * INV_PI;
}`),r.add(n["a"]`const vec4 c0 = vec4(-1.0, -0.0275, -0.572,  0.022);
const vec4 c1 = vec4( 1.0,  0.0425,  1.040, -0.040);
const vec2 c2 = vec2(-1.04, 1.04);
vec2 prefilteredDFGAnalytical(float roughness, float NdotV) {
vec4 r = roughness * c0 + c1;
float a004 = min(r.x * r.x, exp2(-9.28 * NdotV)) * r.x + r.y;
return c2 * a004 + r.zw;
}`),r.add(n["a"]`vec3 evaluateEnvironmentIllumination(PBRShadingInfo inputs) {
vec3 indirectDiffuse = evaluateDiffuseIlluminationHemisphere(inputs.groundIrradianceToSurface, inputs.skyIrradianceToSurface, inputs.NdotNG);
vec3 indirectSpecular = evaluateSpecularIlluminationHemisphere(inputs.groundRadianceToSurface, inputs.skyRadianceToSurface, inputs.RdotNG, inputs.roughness);
vec3 diffuseComponent = inputs.diffuseColor * indirectDiffuse * INV_PI;
vec2 dfg = prefilteredDFGAnalytical(inputs.roughness, inputs.NdotV);
vec3 specularColor = inputs.f0 * dfg.x + inputs.f90 * dfg.y;
vec3 specularComponent = specularColor * indirectSpecular;
return (diffuseComponent + specularComponent);
}`),r.add(n["a"]`float gamutMapChanel(float x, vec2 p){
return (x < p.x) ? mix(0.0, p.y, x/p.x) : mix(p.y, 1.0, (x - p.x) / (1.0 - p.x) );
}`),r.add(n["a"]`vec3 blackLevelSoftCompression(vec3 inColor, PBRShadingInfo inputs){
vec3 outColor;
vec2 p = vec2(0.02 * (inputs.averageAmbientRadiance), 0.0075 * (inputs.averageAmbientRadiance));
outColor.x = gamutMapChanel(inColor.x, p) ;
outColor.y = gamutMapChanel(inColor.y, p) ;
outColor.z = gamutMapChanel(inColor.z, p) ;
return outColor;
}`))}},"68af":function(t,e,r){"use strict";r.d(e,"a",(function(){return s}));var n=r("b2b2"),i=r("d7f7");class s extends i["a"]{constructor(t){super(t),this._numLoading=0,this._disposed=!1,this._textureRepository=t.textureRep,this._textureId=t.textureId,this._acquire(t.textureId).then(t=>this._texture=t),this._acquire(t.normalTextureId).then(t=>this._textureNormal=t),this._acquire(t.emissiveTextureId).then(t=>this._textureEmissive=t),this._acquire(t.occlusionTextureId).then(t=>this._textureOcclusion=t),this._acquire(t.metallicRoughnessTextureId).then(t=>this._textureMetallicRoughness=t)}dispose(){this._texture=Object(n["r"])(this._texture),this._textureNormal=Object(n["r"])(this._textureNormal),this._textureEmissive=Object(n["r"])(this._textureEmissive),this._textureOcclusion=Object(n["r"])(this._textureOcclusion),this._textureMetallicRoughness=Object(n["r"])(this._textureMetallicRoughness),this._disposed=!0}ensureResources(t){return 0===this._numLoading?2:1}updateTexture(t){(Object(n["k"])(this._texture)||t!==this._texture.id)&&(this._texture=Object(n["r"])(this._texture),this._textureId=t,this._acquire(this._textureId).then(t=>this._texture=t))}bindTextures(t){Object(n["l"])(this._texture)&&t.bindTexture(this._texture.glTexture,"tex"),Object(n["l"])(this._textureNormal)&&t.bindTexture(this._textureNormal.glTexture,"normalTexture"),Object(n["l"])(this._textureEmissive)&&t.bindTexture(this._textureEmissive.glTexture,"texEmission"),Object(n["l"])(this._textureOcclusion)&&t.bindTexture(this._textureOcclusion.glTexture,"texOcclusion"),Object(n["l"])(this._textureMetallicRoughness)&&t.bindTexture(this._textureMetallicRoughness.glTexture,"texMetallicRoughness")}bindTextureScale(t){const e=Object(n["l"])(this._texture)?this._texture.glTexture:null;Object(n["l"])(e)&&e.descriptor.textureCoordinateScaleFactor?t.setUniform2fv("textureCoordinateScaleFactor",e.descriptor.textureCoordinateScaleFactor):t.setUniform2f("textureCoordinateScaleFactor",1,1)}_acquire(t){return Object(n["k"])(t)?Promise.resolve(null):(++this._numLoading,this._textureRepository.acquire(t).then(t=>this._disposed?(Object(n["r"])(t),null):t).finally(()=>--this._numLoading))}}},"690a":function(t,e,r){"use strict";r.d(e,"a",(function(){return o}));var n=r("e92d");const i=n["a"].getLogger("esri.views.3d.webgl-engine.core.shaderModules.shaderBuilder");class s{constructor(){this.includedModules=new Map}include(t,e){this.includedModules.has(t)?this.includedModules.get(t)!==e&&i.error("Trying to include shader module multiple times with different sets of options."):(this.includedModules.set(t,e),t(this.builder,e))}}class o extends s{constructor(){super(...arguments),this.vertex=new u,this.fragment=new u,this.attributes=new f,this.varyings=new l,this.extensions=new d,this.constants=new h}get fragmentUniforms(){return this.fragment.uniforms}get builder(){return this}generateSource(t){const e=this.extensions.generateSource(t),r=this.attributes.generateSource(t),n=this.varyings.generateSource(),i="vertex"===t?this.vertex:this.fragment,s=i.uniforms.generateSource(),o=i.code.generateSource(),a="vertex"===t?b:p,c=this.constants.generateSource().concat(i.constants.generateSource());return`\n${e.join("\n")}\n\n${a}\n\n${c.join("\n")}\n\n${s.join("\n")}\n\n${r.join("\n")}\n\n${n.join("\n")}\n\n${o.join("\n")}`}}class a{constructor(){this._entries=new Map}add(t,e,r){const n=`${t}_${e}_${r}`;return this._entries.set(n,{name:t,type:e,arraySize:r}),this}generateSource(){const t=t=>t?`[${t}]`:"";return Array.from(this._entries.values()).map(e=>`uniform ${e.type} ${e.name}${t(e.arraySize)};`)}get entries(){return Array.from(this._entries.values())}}class c{constructor(){this._entries=new Array}add(t){this._entries.push(t)}generateSource(){return this._entries}}class u extends s{constructor(){super(...arguments),this.uniforms=new a,this.code=new c,this.constants=new h}get builder(){return this}}class f{constructor(){this._entries=new Array}add(t,e){this._entries.push([t,e])}generateSource(t){return"fragment"===t?[]:this._entries.map(t=>`attribute ${t[1]} ${t[0]};`)}}class l{constructor(){this._entries=new Array}add(t,e){this._entries.push([t,e])}generateSource(){return this._entries.map(t=>`varying ${t[1]} ${t[0]};`)}}class d{constructor(){this._entries=new Set}add(t){this._entries.add(t)}generateSource(t){const e="vertex"===t?d.ALLOWLIST_VERTEX:d.ALLOWLIST_FRAGMENT;return Array.from(this._entries).filter(t=>e.includes(t)).map(t=>`#extension ${t} : enable`)}}d.ALLOWLIST_FRAGMENT=["GL_EXT_shader_texture_lod","GL_OES_standard_derivatives"],d.ALLOWLIST_VERTEX=[];class h{constructor(){this._entries=[]}add(t,e,r){let n="ERROR_CONSTRUCTOR_STRING";switch(e){case"float":n=h.numberToFloatStr(r);break;case"int":n=h.numberToIntStr(r);break;case"bool":n=r.toString();break;case"vec2":n=`vec2(${h.numberToFloatStr(r[0])},                            ${h.numberToFloatStr(r[1])})`;break;case"vec3":n=`vec3(${h.numberToFloatStr(r[0])},                            ${h.numberToFloatStr(r[1])},                            ${h.numberToFloatStr(r[2])})`;break;case"vec4":n=`vec4(${h.numberToFloatStr(r[0])},                            ${h.numberToFloatStr(r[1])},                            ${h.numberToFloatStr(r[2])},                            ${h.numberToFloatStr(r[3])})`;break;case"ivec2":n=`ivec2(${h.numberToIntStr(r[0])},                             ${h.numberToIntStr(r[1])})`;break;case"ivec3":n=`ivec3(${h.numberToIntStr(r[0])},                             ${h.numberToIntStr(r[1])},                             ${h.numberToIntStr(r[2])})`;break;case"ivec4":n=`ivec4(${h.numberToIntStr(r[0])},                             ${h.numberToIntStr(r[1])},                             ${h.numberToIntStr(r[2])},                             ${h.numberToIntStr(r[3])})`;break;case"mat2":case"mat3":case"mat4":n=`${e}(${Array.prototype.map.call(r,t=>h.numberToFloatStr(t)).join(", ")})`}return this._entries.push(`const ${e} ${t} = ${n};`),this}static numberToIntStr(t){return t.toFixed(0)}static numberToFloatStr(t){return Number.isInteger(t)?t.toFixed(1):t.toString()}generateSource(){return Array.from(this._entries)}}const p="#ifdef GL_FRAGMENT_PRECISION_HIGH\n  precision highp float;\n  precision highp sampler2D;\n#else\n  precision mediump float;\n  precision mediump sampler2D;\n#endif",b="precision highp float;\nprecision highp sampler2D;"},"6a07":function(t,e,r){"use strict";r.d(e,"a",(function(){return a})),r.d(e,"b",(function(){return c}));var n=r("0fc4"),i=r("3886");const s=Object(n["g"])(1,1,0,1),o=Object(n["g"])(1,0,1,1);function a(t){t.fragment.uniforms.add("depthTex","sampler2D"),t.fragment.uniforms.add("highlightViewportPixelSz","vec4"),t.fragment.constants.add("occludedHighlightFlag","vec4",s).add("unoccludedHighlightFlag","vec4",o),t.fragment.code.add(i["a"]`void outputHighlight() {
vec4 fragCoord = gl_FragCoord;
float sceneDepth = texture2D(depthTex, (fragCoord.xy - highlightViewportPixelSz.xy) * highlightViewportPixelSz.zw).r;
if (fragCoord.z > sceneDepth + 5e-7) {
gl_FragColor = occludedHighlightFlag;
}
else {
gl_FragColor = unoccludedHighlightFlag;
}
}`)}function c(t,e){t.bindTexture(e.highlightDepthTexture,"depthTex"),t.setUniform4f("highlightViewportPixelSz",0,0,e.inverseViewport[0],e.inverseViewport[1])}},"6d5b":function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=r("3886");function i(t,e){e.attributeColor?(t.attributes.add("color","vec4"),t.varyings.add("vColor","vec4"),t.vertex.code.add(n["a"]`void forwardVertexColor() { vColor = color; }`),t.vertex.code.add(n["a"]`void forwardNormalizedVertexColor() { vColor = color * 0.003921568627451; }`)):t.vertex.code.add(n["a"]`void forwardVertexColor() {}
void forwardNormalizedVertexColor() {}`)}},7361:function(t,e,r){"use strict";r.d(e,"a",(function(){return b})),r.d(e,"b",(function(){return m})),r.d(e,"c",(function(){return d})),r.d(e,"d",(function(){return h})),r.d(e,"e",(function(){return p}));var n=r("2ab7"),i=r("dae5"),s=r("afe1"),o=r("b139"),a=r("02f1"),c=r("0b2d"),u=r("0fc4");class f{constructor(t,e,r){this.itemByteSize=t,this.itemCreate=e,this._buffers=new Array,this._items=new Array,this._itemsPtr=0,this._itemsPerBuffer=Math.ceil(r/this.itemByteSize)}get(){0===this._itemsPtr&&Object(n["a"])(()=>this.reset());const t=Math.floor(this._itemsPtr/this._itemsPerBuffer);for(;this._buffers.length<=t;){const t=new ArrayBuffer(this._itemsPerBuffer*this.itemByteSize);for(let e=0;e<this._itemsPerBuffer;++e)this._items.push(this.itemCreate(t,e*this.itemByteSize));this._buffers.push(t)}return this._items[this._itemsPtr++]}reset(){const t=2*(Math.floor(this._itemsPtr/this._itemsPerBuffer)+1);for(;this._buffers.length>t;)this._buffers.pop(),this._items.length=this._buffers.length*this._itemsPerBuffer;this._itemsPtr=0}static createVec2f64(t=l){return new f(16,a["c"],t)}static createVec3f64(t=l){return new f(24,c["e"],t)}static createVec4f64(t=l){return new f(32,u["c"],t)}static createMat3f64(t=l){return new f(72,i["a"],t)}static createMat4f64(t=l){return new f(128,s["b"],t)}static createQuatf64(t=l){return new f(32,o["d"],t)}get test(){return{size:this._buffers.length*this._itemsPerBuffer*this.itemByteSize}}}const l=4096,d=f.createVec2f64(),h=f.createVec3f64(),p=f.createVec4f64(),b=(f.createMat3f64(),f.createMat4f64()),m=f.createQuatf64()},7438:function(t,e,r){"use strict";r.d(e,"a",(function(){return a})),r.d(e,"b",(function(){return d})),r.d(e,"c",(function(){return c})),r.d(e,"d",(function(){return f})),r.d(e,"e",(function(){return u})),r.d(e,"f",(function(){return o})),r.d(e,"g",(function(){return i})),r.d(e,"h",(function(){return l}));var n=r("189c");const i=Object(n["g"])(770,1,771,771),s=Object(n["h"])(1,1),o=Object(n["h"])(0,771);function a(t){return 2===t?null:1===t?o:s}function c(t){return 2===t?n["d"]:null}const u=5e5,f={factor:-1,units:-2};function l(t){return t?f:null}function d(t){return 3===t||2===t?513:515}},"7c51":function(t,e,r){"use strict";r.d(e,"a",(function(){return w})),r.d(e,"b",(function(){return P})),r.d(e,"c",(function(){return M})),r.d(e,"d",(function(){return x})),r.d(e,"e",(function(){return A})),r.d(e,"f",(function(){return d})),r.d(e,"g",(function(){return m})),r.d(e,"h",(function(){return j})),r.d(e,"i",(function(){return S}));var n=r("38a4"),i=r("b2b2"),s=r("e431"),o=r("0b2d"),a=r("4261"),c=r("da1c"),u=r("1153"),f=r("b623");const l=Object(a["f"])();function d(t,e,r,n,i,s,o){if(!Object(f["d"])(e))if(t.boundingInfo){Object(u["a"])(0===t.primitiveType);const e=r.tolerance;p(t.boundingInfo,n,i,e,s,o)}else{const e=t.indices.get("position"),r=t.vertexAttributes.get("position");m(n,i,0,e.length/3,e,r,void 0,s,o)}}const h=Object(o["f"])();function p(t,e,r,n,s,o){if(Object(i["k"])(t))return;const c=O(e,r,h);if(Object(a["y"])(l,t.getBBMin()),Object(a["x"])(l,t.getBBMax()),Object(i["l"])(s)&&s.applyToAabb(l),x(l,e,c,n)){const{primitiveIndices:i,indices:a,position:c}=t,u=i?i.length:a.length/3;if(u>B){const i=t.getChildren();if(void 0!==i){for(let t=0;t<8;++t)void 0!==i[t]&&p(i[t],e,r,n,s,o);return}}m(e,r,0,u,a,c,i,s,o)}}const b=Object(o["f"])();function m(t,e,r,n,s,o,a,c,u){if(a)return g(t,e,r,n,s,o,a,c,u);const f=o.data,l=o.stride||o.size,d=t[0],h=t[1],p=t[2],m=e[0]-d,v=e[1]-h,y=e[2]-p;for(let g=r,O=3*r;g<n;++g){let t=l*s[O++],e=f[t++],r=f[t++],n=f[t];t=l*s[O++];let o=f[t++],a=f[t++],x=f[t];t=l*s[O++];let T=f[t++],S=f[t++],w=f[t];Object(i["l"])(c)&&([e,r,n]=c.applyToVertex(e,r,n,g),[o,a,x]=c.applyToVertex(o,a,x,g),[T,S,w]=c.applyToVertex(T,S,w,g));const M=o-e,j=a-r,A=x-n,E=T-e,P=S-r,B=w-n,I=v*B-P*y,F=y*E-B*m,L=m*P-E*v,z=M*I+j*F+A*L;if(Math.abs(z)<=Number.EPSILON)continue;const C=d-e,D=h-r,N=p-n,R=C*I+D*F+N*L;if(z>0){if(R<0||R>z)continue}else if(R>0||R<z)continue;const U=D*A-j*N,V=N*M-A*C,H=C*j-M*D,k=m*U+v*V+y*H;if(z>0){if(k<0||R+k>z)continue}else if(k>0||R+k<z)continue;const W=(E*U+P*V+B*H)/z;W>=0&&u(W,_(M,j,A,E,P,B,b),g,!1)}}function g(t,e,r,n,s,o,a,c,u){const f=o.data,l=o.stride||o.size,d=t[0],h=t[1],p=t[2],m=e[0]-d,g=e[1]-h,v=e[2]-p;for(let y=r;y<n;++y){const t=a[y];let e=3*t,r=l*s[e++],n=f[r++],o=f[r++],O=f[r];r=l*s[e++];let x=f[r++],T=f[r++],S=f[r];r=l*s[e];let w=f[r++],M=f[r++],j=f[r];Object(i["l"])(c)&&([n,o,O]=c.applyToVertex(n,o,O,y),[x,T,S]=c.applyToVertex(x,T,S,y),[w,M,j]=c.applyToVertex(w,M,j,y));const A=x-n,E=T-o,P=S-O,B=w-n,I=M-o,F=j-O,L=g*F-I*v,z=v*B-F*m,C=m*I-B*g,D=A*L+E*z+P*C;if(Math.abs(D)<=Number.EPSILON)continue;const N=d-n,R=h-o,U=p-O,V=N*L+R*z+U*C;if(D>0){if(V<0||V>D)continue}else if(V>0||V<D)continue;const H=R*P-E*U,k=U*A-P*N,W=N*E-A*R,q=m*H+g*k+v*W;if(D>0){if(q<0||V+q>D)continue}else if(q>0||V+q<D)continue;const G=(B*H+I*k+F*W)/D;G>=0&&u(G,_(A,E,P,B,I,F,b),t,!1)}}const v=Object(o["f"])(),y=Object(o["f"])();function _(t,e,r,n,i,o,a){return Object(s["w"])(v,t,e,r),Object(s["w"])(y,n,i,o),Object(s["g"])(a,v,y),Object(s["r"])(a,a),a}function O(t,e,r){return Object(s["w"])(r,1/(e[0]-t[0]),1/(e[1]-t[1]),1/(e[2]-t[2]))}function x(t,e,r,n){return T(t,e,r,n,1/0)}function T(t,e,r,n,i){const s=(t[0]-n-e[0])*r[0],o=(t[3]+n-e[0])*r[0];let a=Math.min(s,o),c=Math.max(s,o);const u=(t[1]-n-e[1])*r[1],f=(t[4]+n-e[1])*r[1];if(c=Math.min(c,Math.max(u,f)),c<0)return!1;if(a=Math.max(a,Math.min(u,f)),a>c)return!1;const l=(t[2]-n-e[2])*r[2],d=(t[5]+n-e[2])*r[2];return c=Math.min(c,Math.max(l,d)),!(c<0)&&(a=Math.max(a,Math.min(l,d)),!(a>c)&&a<i)}function S(t,e,r,i,s){let o=(r.screenLength||0)*t.pixelRatio;s&&(o=Object(c["d"])(o,i,e,s));const a=o*Math.tan(.5*t.fovY)/(.5*t.fullHeight);return Object(n["d"])(a*e,r.minWorldLength||0,null!=r.maxWorldLength?r.maxWorldLength:1/0)}function w(t,e,r){if(!t)return;const n=t.parameters,i=t.paddingPixelsOverride;e.setUniform4f(r,n.divisor,n.offset,n.minPixelSize,i)}function M(t,e){const r=e?M(e):{};for(const n in t){let e=t[n];e&&e.forEach&&(e=E(e)),null==e&&n in r||(r[n]=e)}return r}function j(t,e){let r=!1;for(const n in e){const i=e[n];void 0!==i&&(r=!0,Array.isArray(i)?t[n]=i.slice():t[n]=i)}return r}function A(t,e,r,i,s,o){if(!e.options.selectionMode)return;const a=t.vertexAttributes.get("position").data,c=t.vertexAttributes.get("size"),u=c&&c.data[0],f=i[0],l=i[1],d=((u+s)/2+4)*t.screenToWorldRatio;let h=Number.MAX_VALUE,p=0;for(let b=0;b<a.length-5;b+=3){const t=a[b],e=a[b+1],r=f-t,i=l-e,s=a[b+3]-t,o=a[b+4]-e,c=Object(n["d"])((s*r+o*i)/(s*s+o*o),0,1),u=s*c-r,d=o*c-i,m=u*u+d*d;m<h&&(h=m,p=b/3)}h<d*d&&o(r.dist,r.normal,p,!1)}function E(t){const e=[];return t.forEach(t=>e.push(t)),e}const P={multiply:1,ignore:2,replace:3,tint:4},B=1e3},8190:function(t,e,r){"use strict";r.d(e,"a",(function(){return d})),r.d(e,"b",(function(){return _})),r.d(e,"c",(function(){return U})),r.d(e,"d",(function(){return W})),r.d(e,"e",(function(){return C})),r.d(e,"f",(function(){return m})),r.d(e,"g",(function(){return g})),r.d(e,"h",(function(){return v})),r.d(e,"i",(function(){return y})),r.d(e,"j",(function(){return A})),r.d(e,"k",(function(){return I})),r.d(e,"l",(function(){return S})),r.d(e,"m",(function(){return h})),r.d(e,"n",(function(){return O})),r.d(e,"o",(function(){return V})),r.d(e,"p",(function(){return q})),r.d(e,"q",(function(){return D})),r.d(e,"r",(function(){return E})),r.d(e,"s",(function(){return F})),r.d(e,"t",(function(){return w})),r.d(e,"u",(function(){return p})),r.d(e,"v",(function(){return x})),r.d(e,"w",(function(){return H})),r.d(e,"x",(function(){return G})),r.d(e,"y",(function(){return N})),r.d(e,"z",(function(){return P})),r.d(e,"A",(function(){return L})),r.d(e,"B",(function(){return M})),r.d(e,"C",(function(){return b})),r.d(e,"D",(function(){return T})),r.d(e,"E",(function(){return k})),r.d(e,"F",(function(){return $})),r.d(e,"G",(function(){return R})),r.d(e,"H",(function(){return B})),r.d(e,"I",(function(){return z})),r.d(e,"J",(function(){return j}));class n{constructor(t,e,r=0,n,i){this.TypedArrayConstructor=t,this.elementCount=9;const s=this.TypedArrayConstructor;void 0===n&&(n=9*s.BYTES_PER_ELEMENT);const o=0===e.byteLength?0:r;this.typedBuffer=null==i?new s(e,o):new s(e,o,(i-r)/s.BYTES_PER_ELEMENT),this.typedBufferStride=n/s.BYTES_PER_ELEMENT,this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride),this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}sliceBuffer(t,e,r=this.count-e){const n=this.typedBuffer.byteOffset+e*this.stride;return new t(this.buffer,n,this.stride,n+r*this.stride)}getMat(t,e){let r=t*this.typedBufferStride;for(let n=0;n<9;n++)e[n]=this.typedBuffer[r++];return e}setMat(t,e){let r=t*this.typedBufferStride;for(let n=0;n<9;n++)this.typedBuffer[r++]=e[n]}get(t,e){return this.typedBuffer[t*this.typedBufferStride+e]}set(t,e,r){this.typedBuffer[t*this.typedBufferStride+e]=r}copyFrom(t,e,r){const n=this.typedBuffer,i=e.typedBuffer;let s=t*this.typedBufferStride,o=r*e.typedBufferStride;for(let a=0;a<9;++a)n[s++]=i[o++]}get buffer(){return this.typedBuffer.buffer}}n.ElementCount=9;class i{constructor(t,e,r=0,n,i){this.TypedArrayConstructor=t,this.elementCount=16;const s=this.TypedArrayConstructor;void 0===n&&(n=16*s.BYTES_PER_ELEMENT);const o=0===e.byteLength?0:r;this.typedBuffer=null==i?new s(e,o):new s(e,o,(i-r)/s.BYTES_PER_ELEMENT),this.typedBufferStride=n/s.BYTES_PER_ELEMENT,this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride),this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}sliceBuffer(t,e,r=this.count-e){const n=this.typedBuffer.byteOffset+e*this.stride;return new t(this.buffer,n,this.stride,n+r*this.stride)}getMat(t,e){let r=t*this.typedBufferStride;for(let n=0;n<16;n++)e[n]=this.typedBuffer[r++];return e}setMat(t,e){let r=t*this.typedBufferStride;for(let n=0;n<16;n++)this.typedBuffer[r++]=e[n]}get(t,e){return this.typedBuffer[t*this.typedBufferStride+e]}set(t,e,r){this.typedBuffer[t*this.typedBufferStride+e]=r}copyFrom(t,e,r){const n=this.typedBuffer,i=e.typedBuffer;let s=t*this.typedBufferStride,o=r*e.typedBufferStride;for(let a=0;a<16;++a)n[s++]=i[o++]}get buffer(){return this.typedBuffer.buffer}}i.ElementCount=16;class s{constructor(t,e,r=0,n,i){this.TypedArrayConstructor=t,this.elementCount=1;const s=this.TypedArrayConstructor;void 0===n&&(n=s.BYTES_PER_ELEMENT);const o=0===e.byteLength?0:r;this.typedBuffer=null==i?new s(e,o):new s(e,o,(i-r)/s.BYTES_PER_ELEMENT),this.typedBufferStride=n/s.BYTES_PER_ELEMENT,this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride),this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}sliceBuffer(t,e,r=this.count-e){const n=this.typedBuffer.byteOffset+e*this.stride;return new t(this.buffer,n,this.stride,n+r*this.stride)}get(t){return this.typedBuffer[t*this.typedBufferStride]}set(t,e){this.typedBuffer[t*this.typedBufferStride]=e}get buffer(){return this.typedBuffer.buffer}}s.ElementCount=1;var o=r("3349");class a{constructor(t,e,r=0,n,i){this.TypedArrayConstructor=t,this.elementCount=2;const s=this.TypedArrayConstructor;void 0===n&&(n=2*s.BYTES_PER_ELEMENT);const o=0===e.byteLength?0:r;this.typedBuffer=null==i?new s(e,o):new s(e,o,(i-r)/s.BYTES_PER_ELEMENT),this.typedBufferStride=n/s.BYTES_PER_ELEMENT,this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride),this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}sliceBuffer(t,e,r=this.count-e){const n=this.typedBuffer.byteOffset+e*this.stride;return new t(this.buffer,n,this.stride,n+r*this.stride)}getVec(t,e){return t*=this.typedBufferStride,Object(o["s"])(e,this.typedBuffer[t],this.typedBuffer[t+1])}setVec(t,e){t*=this.typedBufferStride,this.typedBuffer[t++]=e[0],this.typedBuffer[t]=e[1]}get(t,e){return this.typedBuffer[t*this.typedBufferStride+e]}set(t,e,r){this.typedBuffer[t*this.typedBufferStride+e]=r}setValues(t,e,r){t*=this.typedBufferStride,this.typedBuffer[t++]=e,this.typedBuffer[t]=r}copyFrom(t,e,r){const n=this.typedBuffer,i=e.typedBuffer;let s=t*this.typedBufferStride,o=r*e.typedBufferStride;n[s++]=i[o++],n[s]=i[o]}get buffer(){return this.typedBuffer.buffer}}a.ElementCount=2;var c=r("e431");class u{constructor(t,e,r=0,n,i){this.TypedArrayConstructor=t,this.elementCount=3;const s=this.TypedArrayConstructor;void 0===n&&(n=3*s.BYTES_PER_ELEMENT);const o=0===e.byteLength?0:r;this.typedBuffer=null==i?new s(e,o):new s(e,o,(i-r)/s.BYTES_PER_ELEMENT),this.typedBufferStride=n/s.BYTES_PER_ELEMENT,this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride),this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}sliceBuffer(t,e,r=this.count-e){const n=this.typedBuffer.byteOffset+e*this.stride;return new t(this.buffer,n,this.stride,n+r*this.stride)}getVec(t,e){return t*=this.typedBufferStride,Object(c["w"])(e,this.typedBuffer[t],this.typedBuffer[t+1],this.typedBuffer[t+2])}setVec(t,e){t*=this.typedBufferStride,this.typedBuffer[t++]=e[0],this.typedBuffer[t++]=e[1],this.typedBuffer[t]=e[2]}get(t,e){return this.typedBuffer[t*this.typedBufferStride+e]}set(t,e,r){this.typedBuffer[t*this.typedBufferStride+e]=r}setValues(t,e,r,n){t*=this.typedBufferStride,this.typedBuffer[t++]=e,this.typedBuffer[t++]=r,this.typedBuffer[t]=n}copyFrom(t,e,r){const n=this.typedBuffer,i=e.typedBuffer;let s=t*this.typedBufferStride,o=r*e.typedBufferStride;n[s++]=i[o++],n[s++]=i[o++],n[s]=i[o]}get buffer(){return this.typedBuffer.buffer}}u.ElementCount=3;var f=r("7577");class l{constructor(t,e,r=0,n,i){this.TypedArrayConstructor=t,this.elementCount=4;const s=this.TypedArrayConstructor;void 0===n&&(n=4*s.BYTES_PER_ELEMENT);const o=0===e.byteLength?0:r;this.typedBuffer=null==i?new s(e,o):new s(e,o,(i-r)/s.BYTES_PER_ELEMENT),this.typedBufferStride=n/s.BYTES_PER_ELEMENT,this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride),this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}sliceBuffer(t,e,r=this.count-e){const n=this.typedBuffer.byteOffset+e*this.stride;return new t(this.buffer,n,this.stride,n+r*this.stride)}getVec(t,e){return t*=this.typedBufferStride,Object(f["l"])(e,this.typedBuffer[t++],this.typedBuffer[t++],this.typedBuffer[t++],this.typedBuffer[t])}setVec(t,e){t*=this.typedBufferStride,this.typedBuffer[t++]=e[0],this.typedBuffer[t++]=e[1],this.typedBuffer[t++]=e[2],this.typedBuffer[t]=e[3]}get(t,e){return this.typedBuffer[t*this.typedBufferStride+e]}set(t,e,r){this.typedBuffer[t*this.typedBufferStride+e]=r}setValues(t,e,r,n,i){t*=this.typedBufferStride,this.typedBuffer[t++]=e,this.typedBuffer[t++]=r,this.typedBuffer[t++]=n,this.typedBuffer[t]=i}copyFrom(t,e,r){const n=this.typedBuffer,i=e.typedBuffer;let s=t*this.typedBufferStride,o=r*e.typedBufferStride;n[s++]=i[o++],n[s++]=i[o++],n[s++]=i[o++],n[s]=i[o]}get buffer(){return this.typedBuffer.buffer}}l.ElementCount=4;class d extends s{constructor(t,e=0,r,n){super(Float32Array,t,e,r,n),this.elementType="f32"}static fromTypedArray(t,e){return new d(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}d.ElementType="f32";class h extends a{constructor(t,e=0,r,n){super(Float32Array,t,e,r,n),this.elementType="f32"}slice(t,e){return this.sliceBuffer(h,t,e)}static fromTypedArray(t,e){return new h(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}h.ElementType="f32";class p extends u{constructor(t,e=0,r,n){super(Float32Array,t,e,r,n),this.elementType="f32"}slice(t,e){return this.sliceBuffer(p,t,e)}static fromTypedArray(t,e){return new p(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}p.ElementType="f32";class b extends l{constructor(t,e=0,r,n){super(Float32Array,t,e,r,n),this.elementType="f32"}slice(t,e){return this.sliceBuffer(b,t,e)}static fromTypedArray(t,e){return new b(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}b.ElementType="f32";class m extends n{constructor(t,e=0,r,n){super(Float32Array,t,e,r,n),this.elementType="f32"}slice(t,e){return this.sliceBuffer(m,t,e)}static fromTypedArray(t,e){return new m(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}m.ElementType="f32";class g extends n{constructor(t,e=0,r,n){super(Float64Array,t,e,r,n),this.elementType="f64"}slice(t,e){return this.sliceBuffer(g,t,e)}static fromTypedArray(t,e){return new g(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}g.ElementType="f64";class v extends i{constructor(t,e=0,r,n){super(Float32Array,t,e,r,n),this.elementType="f32"}slice(t,e){return this.sliceBuffer(v,t,e)}static fromTypedArray(t,e){return new v(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}v.ElementType="f32";class y extends i{constructor(t,e=0,r,n){super(Float64Array,t,e,r,n),this.elementType="f64"}slice(t,e){return this.sliceBuffer(y,t,e)}static fromTypedArray(t,e){return new y(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}y.ElementType="f64";class _ extends s{constructor(t,e=0,r,n){super(Float64Array,t,e,r,n),this.elementType="f64"}slice(t,e){return this.sliceBuffer(_,t,e)}static fromTypedArray(t,e){return new _(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}_.ElementType="f64";class O extends a{constructor(t,e=0,r,n){super(Float64Array,t,e,r,n),this.elementType="f64"}slice(t,e){return this.sliceBuffer(O,t,e)}static fromTypedArray(t,e){return new O(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}O.ElementType="f64";class x extends u{constructor(t,e=0,r,n){super(Float64Array,t,e,r,n),this.elementType="f64"}slice(t,e){return this.sliceBuffer(x,t,e)}static fromTypedArray(t,e){return new x(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}x.ElementType="f64";class T extends l{constructor(t,e=0,r,n){super(Float64Array,t,e,r,n),this.elementType="f64"}slice(t,e){return this.sliceBuffer(T,t,e)}static fromTypedArray(t,e){return new T(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}T.ElementType="f64";class S extends s{constructor(t,e=0,r,n){super(Uint8Array,t,e,r,n),this.elementType="u8"}slice(t,e){return this.sliceBuffer(S,t,e)}static fromTypedArray(t,e){return new S(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}S.ElementType="u8";class w extends a{constructor(t,e=0,r,n){super(Uint8Array,t,e,r,n),this.elementType="u8"}slice(t,e){return this.sliceBuffer(w,t,e)}static fromTypedArray(t,e){return new w(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}w.ElementType="u8";class M extends u{constructor(t,e=0,r,n){super(Uint8Array,t,e,r,n),this.elementType="u8"}slice(t,e){return this.sliceBuffer(M,t,e)}static fromTypedArray(t,e){return new M(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}M.ElementType="u8";class j extends l{constructor(t,e=0,r,n){super(Uint8Array,t,e,r,n),this.elementType="u8"}slice(t,e){return this.sliceBuffer(j,t,e)}static fromTypedArray(t,e){return new j(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}j.ElementType="u8";class A extends s{constructor(t,e=0,r,n){super(Uint16Array,t,e,r,n),this.elementType="u16"}slice(t,e){return this.sliceBuffer(A,t,e)}static fromTypedArray(t,e){return new A(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}A.ElementType="u16";class E extends a{constructor(t,e=0,r,n){super(Uint16Array,t,e,r,n),this.elementType="u16"}slice(t,e){return this.sliceBuffer(E,t,e)}static fromTypedArray(t,e){return new E(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}E.ElementType="u16";class P extends u{constructor(t,e=0,r,n){super(Uint16Array,t,e,r,n),this.elementType="u16"}slice(t,e){return this.sliceBuffer(P,t,e)}static fromTypedArray(t,e){return new P(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}P.ElementType="u16";class B extends l{constructor(t,e=0,r,n){super(Uint16Array,t,e,r,n),this.elementType="u16"}slice(t,e){return this.sliceBuffer(B,t,e)}static fromTypedArray(t,e){return new B(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}B.ElementType="u16";class I extends s{constructor(t,e=0,r,n){super(Uint32Array,t,e,r,n),this.elementType="u32"}slice(t,e){return this.sliceBuffer(I,t,e)}static fromTypedArray(t,e){return new I(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}I.ElementType="u32";class F extends a{constructor(t,e=0,r,n){super(Uint32Array,t,e,r,n),this.elementType="u32"}slice(t,e){return this.sliceBuffer(F,t,e)}static fromTypedArray(t,e){return new F(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}F.ElementType="u32";class L extends u{constructor(t,e=0,r,n){super(Uint32Array,t,e,r,n),this.elementType="u32"}slice(t,e){return this.sliceBuffer(L,t,e)}static fromTypedArray(t,e){return new L(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}L.ElementType="u32";class z extends l{constructor(t,e=0,r,n){super(Uint32Array,t,e,r,n),this.elementType="u32"}slice(t,e){return this.sliceBuffer(z,t,e)}static fromTypedArray(t,e){return new z(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}z.ElementType="u32";class C extends s{constructor(t,e=0,r,n){super(Int8Array,t,e,r,n),this.elementType="i8"}slice(t,e){return this.sliceBuffer(C,t,e)}static fromTypedArray(t,e){return new C(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}C.ElementType="i8";class D extends a{constructor(t,e=0,r,n){super(Int8Array,t,e,r,n),this.elementType="i8"}slice(t,e){return this.sliceBuffer(D,t,e)}static fromTypedArray(t,e){return new D(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}D.ElementType="i8";class N extends u{constructor(t,e=0,r,n){super(Int8Array,t,e,r,n),this.elementType="i8"}slice(t,e){return this.sliceBuffer(N,t,e)}static fromTypedArray(t,e){return new N(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}N.ElementType="i8";class R extends l{constructor(t,e=0,r,n){super(Int8Array,t,e,r,n),this.elementType="i8"}slice(t,e){return this.sliceBuffer(R,t,e)}static fromTypedArray(t,e){return new R(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}R.ElementType="i8";class U extends s{constructor(t,e=0,r,n){super(Int16Array,t,e,r,n),this.elementType="i16"}slice(t,e){return this.sliceBuffer(U,t,e)}static fromTypedArray(t,e){return new U(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}U.ElementType="i16";class V extends a{constructor(t,e=0,r,n){super(Int16Array,t,e,r,n),this.elementType="i16"}slice(t,e){return this.sliceBuffer(V,t,e)}static fromTypedArray(t,e){return new V(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}V.ElementType="i16";class H extends u{constructor(t,e=0,r,n){super(Int16Array,t,e,r,n),this.elementType="i16"}slice(t,e){return this.sliceBuffer(H,t,e)}static fromTypedArray(t,e){return new H(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}H.ElementType="i16";class k extends l{constructor(t,e=0,r,n){super(Int16Array,t,e,r,n),this.elementType="i16"}slice(t,e){return this.sliceBuffer(k,t,e)}static fromTypedArray(t,e){return new k(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}k.ElementType="i16";class W extends s{constructor(t,e=0,r,n){super(Int32Array,t,e,r,n),this.elementType="i32"}slice(t,e){return this.sliceBuffer(W,t,e)}static fromTypedArray(t,e){return new W(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}W.ElementType="i32";class q extends a{constructor(t,e=0,r,n){super(Int32Array,t,e,r,n),this.elementType="i32"}slice(t,e){return this.sliceBuffer(q,t,e)}static fromTypedArray(t,e){return new q(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}q.ElementType="i32";class G extends u{constructor(t,e=0,r,n){super(Int32Array,t,e,r,n),this.elementType="i32"}slice(t,e){return this.sliceBuffer(G,t,e)}static fromTypedArray(t,e){return new G(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}G.ElementType="i32";class $ extends l{constructor(t,e=0,r,n){super(Int32Array,t,e,r,n),this.elementType="i32"}slice(t,e){return this.sliceBuffer($,t,e)}static fromTypedArray(t,e){return new $(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}$.ElementType="i32"},"87b7":function(t,e,r){"use strict";r.d(e,"a",(function(){return i})),r.d(e,"b",(function(){return n})),r.d(e,"c",(function(){return a})),r.d(e,"d",(function(){return c})),r.d(e,"e",(function(){return u})),r.d(e,"f",(function(){return f})),r.d(e,"g",(function(){return o})),r.d(e,"h",(function(){return s}));const n={func:513},i={func:519},s={mask:255},o={mask:0},a={function:{func:519,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:0}},c={function:{func:519,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:7681}},u={function:{func:514,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:7680}},f={function:{func:517,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:7680}}},"89bf":function(t,e,r){"use strict";r.d(e,"a",(function(){return b})),r.d(e,"b",(function(){return x})),r.d(e,"c",(function(){return O}));var n=r("b2b2"),i=r("1c92"),s=r("dae5"),o=r("d791"),a=r("afe1"),c=r("04f0"),u=r("b139"),f=r("e431"),l=r("47f8"),d=r("0b2d"),h=r("0fc4"),p=r("f895");class b{constructor(){this._transform=Object(a["d"])(),this._transformInverse=new m({value:this._transform},o["c"],a["d"]),this._transformInverseTranspose=new m(this._transformInverse,o["t"],a["d"]),this._transformTranspose=new m({value:this._transform},o["t"],a["d"]),this._transformInverseRotation=new m({value:this._transform},i["j"],s["b"])}invalidateLazyTransforms(){this._transformInverse.invalidate(),this._transformInverseTranspose.invalidate(),this._transformTranspose.invalidate(),this._transformInverseRotation.invalidate()}get transform(){return this._transform}get inverse(){return this._transformInverse.value}get inverseTranspose(){return this._transformInverseTranspose.value}get inverseRotation(){return this._transformInverseRotation.value}get transpose(){return this._transformTranspose.value}setTransformMatrix(t){Object(o["d"])(this._transform,t)}multiplyTransform(t){Object(o["n"])(this._transform,this._transform,t)}set(t){Object(o["d"])(this._transform,t),this.invalidateLazyTransforms()}setAndInvalidateLazyTransforms(t,e){this.setTransformMatrix(t),this.multiplyTransform(e),this.invalidateLazyTransforms()}}class m{constructor(t,e,r){this.original=t,this.update=e,this.dirty=!0,this.transform=r()}invalidate(){this.dirty=!0}get value(){return this.dirty&&(this.update(this.transform,this.original.value),this.dirty=!1),this.transform}}class g{constructor(t=0){this.offset=t,this.tmpVertex=Object(d["f"])()}applyToVertex(t,e,r){const n=t+this.localOrigin[0],i=e+this.localOrigin[1],s=r+this.localOrigin[2],o=this.offset/Math.sqrt(n*n+i*i+s*s);return this.tmpVertex[0]=t+n*o,this.tmpVertex[1]=e+i*o,this.tmpVertex[2]=r+s*o,this.tmpVertex}applyToAabb(t){const e=t[0]+this.localOrigin[0],r=t[1]+this.localOrigin[1],n=t[2]+this.localOrigin[2],i=t[3]+this.localOrigin[0],s=t[4]+this.localOrigin[1],o=t[5]+this.localOrigin[2],a=this.offset/Math.sqrt(e*e+r*r+n*n);t[0]+=e*a,t[1]+=r*a,t[2]+=n*a;const c=this.offset/Math.sqrt(i*i+s*s+o*o);return t[3]+=i*c,t[4]+=s*c,t[5]+=o*c,t}}class v{constructor(t=0){this.offset=t,this.componentLocalOriginLength=0,this.tmpVertex=Object(d["f"])(),this.mbs=Object(h["e"])(),this.obb={center:Object(d["f"])(),halfSize:Object(l["b"])(),quaternion:null}}set localOrigin(t){this.componentLocalOriginLength=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2])}applyToVertex(t,e,r){const n=t,i=e,s=r+this.componentLocalOriginLength,o=this.offset/Math.sqrt(n*n+i*i+s*s);return this.tmpVertex[0]=t+n*o,this.tmpVertex[1]=e+i*o,this.tmpVertex[2]=r+s*o,this.tmpVertex}applyToAabb(t){const e=t[0],r=t[1],n=t[2]+this.componentLocalOriginLength,i=t[3],s=t[4],o=t[5]+this.componentLocalOriginLength,a=this.offset/Math.sqrt(e*e+r*r+n*n);t[0]+=e*a,t[1]+=r*a,t[2]+=n*a;const c=this.offset/Math.sqrt(i*i+s*s+o*o);return t[3]+=i*c,t[4]+=s*c,t[5]+=o*c,t}applyToMbs(t){const e=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]),r=this.offset/e;return this.mbs[0]=t[0]+t[0]*r,this.mbs[1]=t[1]+t[1]*r,this.mbs[2]=t[2]+t[2]*r,this.mbs[3]=t[3]+t[3]*this.offset/e,this.mbs}applyToObb(t){const e=t.center,r=this.offset/Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);this.obb.center[0]=e[0]+e[0]*r,this.obb.center[1]=e[1]+e[1]*r,this.obb.center[2]=e[2]+e[2]*r,Object(f["u"])(this.obb.halfSize,t.halfSize,t.quaternion),Object(f["f"])(this.obb.halfSize,this.obb.halfSize,t.center);const n=this.offset/Math.sqrt(this.obb.halfSize[0]*this.obb.halfSize[0]+this.obb.halfSize[1]*this.obb.halfSize[1]+this.obb.halfSize[2]*this.obb.halfSize[2]);return this.obb.halfSize[0]+=this.obb.halfSize[0]*n,this.obb.halfSize[1]+=this.obb.halfSize[1]*n,this.obb.halfSize[2]+=this.obb.halfSize[2]*n,Object(f["j"])(this.obb.halfSize,this.obb.halfSize,t.center),Object(c["a"])(T,t.quaternion),Object(f["u"])(this.obb.halfSize,this.obb.halfSize,T),this.obb.halfSize[0]*=this.obb.halfSize[0]<0?-1:1,this.obb.halfSize[1]*=this.obb.halfSize[1]<0?-1:1,this.obb.halfSize[2]*=this.obb.halfSize[2]<0?-1:1,this.obb.quaternion=t.quaternion,this.obb}}class y{constructor(t=0){this.offset=t,this.sphere=Object(p["c"])(),this.tmpVertex=Object(d["f"])()}applyToVertex(t,e,r){const n=this.objectTransform.transform;let i=n[0]*t+n[4]*e+n[8]*r+n[12],s=n[1]*t+n[5]*e+n[9]*r+n[13],o=n[2]*t+n[6]*e+n[10]*r+n[14];const a=this.offset/Math.sqrt(i*i+s*s+o*o);i+=i*a,s+=s*a,o+=o*a;const c=this.objectTransform.inverse;return this.tmpVertex[0]=c[0]*i+c[4]*s+c[8]*o+c[12],this.tmpVertex[1]=c[1]*i+c[5]*s+c[9]*o+c[13],this.tmpVertex[2]=c[2]*i+c[6]*s+c[10]*o+c[14],this.tmpVertex}applyToMinMax(t,e){const r=this.offset/Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]+=t[0]*r,t[1]+=t[1]*r,t[2]+=t[2]*r;const n=this.offset/Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]+=e[0]*n,e[1]+=e[1]*n,e[2]+=e[2]*n}applyToAabb(t){const e=this.offset/Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]+=t[0]*e,t[1]+=t[1]*e,t[2]+=t[2]*e;const r=this.offset/Math.sqrt(t[3]*t[3]+t[4]*t[4]+t[5]*t[5]);return t[3]+=t[3]*r,t[4]+=t[4]*r,t[5]+=t[5]*r,t}applyToBoundingSphere(t){const e=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]),r=this.offset/e;return this.sphere[0]=t[0]+t[0]*r,this.sphere[1]=t[1]+t[1]*r,this.sphere[2]=t[2]+t[2]*r,this.sphere[3]=t[3]+t[3]*this.offset/e,this.sphere}}const _=new y;function O(t){return Object(n["l"])(t)?(_.offset=t,_):null}new v;new g;const x="terrain",T=Object(u["b"])()},"8e97":function(t,e,r){"use strict";r.d(e,"a",(function(){return s})),r.d(e,"b",(function(){return a})),r.d(e,"c",(function(){return o})),r.d(e,"d",(function(){return u})),r.d(e,"e",(function(){return c})),r.d(e,"f",(function(){return f}));var n=r("d791"),i=r("970c");function s(t,e,r){t.setUniform3f("camPos",r[3]-e[0],r[7]-e[1],r[11]-e[2])}function o(t,e){t.setUniformMatrix4fv("proj",e)}function a(t,e){t.setUniform2fv("nearFar",e)}function c(t,e,r){Object(n["b"])(l,r,e),t.setUniform3fv("localOrigin",e),t.setUniformMatrix4fv("view",l)}function u(t,e){c(t,e.origin,e.camera.viewMatrix)}function f(t,e){t.setUniform4fv("viewport",e.camera.fullViewport)}const l=Object(i["a"])()},"9cc4":function(t,e,r){"use strict";function n(t,e,r){for(let n=0;n<r;++n)e[2*n]=t[n],e[2*n+1]=t[n]-e[2*n]}function i(t,e,r,i){for(let a=0;a<i;++a)s[0]=t[a],n(s,o,1),e[a]=o[0],r[a]=o[1]}r.d(e,"a",(function(){return n})),r.d(e,"b",(function(){return i}));const s=new Float64Array(1),o=new Float32Array(2)},a1b1:function(t,e,r){"use strict";r.d(e,"a",(function(){return c})),r.d(e,"b",(function(){return u})),r.d(e,"c",(function(){return o})),r.d(e,"d",(function(){return a}));var n=r("38a4"),i=r("e431"),s=r("0b2d");function o(t,e,r){const n=Object(i["h"])(t,e)/Object(i["h"])(t,t);return Object(i["e"])(r,t,n)}function a(t,e){return Object(i["h"])(t,e)/Object(i["p"])(t)}function c(t,e){const r=Object(i["h"])(t,e)/(Object(i["p"])(t)*Object(i["p"])(e));return-Object(n["a"])(r)}function u(t,e,r){Object(i["r"])(f,t),Object(i["r"])(l,e);const s=Object(i["h"])(f,l),o=Object(n["a"])(s),a=Object(i["g"])(f,f,l);return Object(i["h"])(a,r)<0?2*Math.PI-o:o}const f=Object(s["f"])(),l=Object(s["f"])()},a1ff:function(t,e,r){"use strict";r.d(e,"a",(function(){return u}));var n=r("38a4"),i=r("b2b2"),s=r("1956"),o=r("d17d"),a=r("c514");const c=4;class u{constructor(t,e,r=null){this._context=t,this.type="texture",this._glName=null,this._descriptor=void 0,this._samplingModeDirty=!1,this._wrapModeDirty=!1,t.instanceCounter.increment(o["c"].Texture,this),this._descriptor={target:3553,samplingMode:9729,wrapMode:10497,flipped:!1,hasMipmap:!1,isOpaque:!1,unpackAlignment:4,preMultiplyAlpha:!1,...e},34067===this._descriptor.target?this.setDataCubeMap(r):this.setData(r)}get glName(){return this._glName}get descriptor(){return this._descriptor}get isDirty(){return this._samplingModeDirty||this._wrapModeDirty}dispose(){this._context.gl&&this._glName&&(this._context.unbindTextureAllUnits(this),this._context.gl.deleteTexture(this._glName),this._glName=null,this._context.instanceCounter.decrement(o["c"].Texture,this))}release(){this.dispose()}resize(t,e){const r=this._descriptor;r.width===t&&r.height===e||(r.width=t,r.height=e,34067===this._descriptor.target?this.setDataCubeMap(null):this.setData(null))}setDataCubeMap(t=null){for(let e=34069;e<=34074;e++)this.setData(t,e)}setData(t,e=3553){if(!this._context||!this._context.gl)return;const r=this._context.gl;this._glName||(this._glName=r.createTexture()),void 0===t&&(t=null),null===t&&(this._descriptor.width=this._descriptor.width||c,this._descriptor.height=this._descriptor.height||c);const n=this._context.bindTexture(this,u.TEXTURE_UNIT_FOR_UPDATES),o=this._descriptor;u._validateTexture(this._context,o),r.pixelStorei(r.UNPACK_ALIGNMENT,o.unpackAlignment),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,o.flipped?1:0),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o.preMultiplyAlpha?1:0);const a=o.pixelFormat;let l=o.internalFormat?o.internalFormat:this._deriveInternalFormat(a,o.dataType);if(t instanceof ImageData||t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement){let n=t.width,i=t.height;t instanceof HTMLVideoElement&&(n=t.videoWidth,i=t.videoHeight),o.width&&o.height,r.texImage2D(e,0,l,a,o.dataType,t),Object(s["a"])(r),o.hasMipmap&&this.generateMipmap(),void 0===o.width&&(o.width=n),void 0===o.height&&(o.height=i)}else{null!=o.width&&null!=o.height||console.error("Width and height must be specified!"),r.DEPTH24_STENCIL8&&l===r.DEPTH_STENCIL&&(l=r.DEPTH24_STENCIL8);let n=o.width,c=o.height;if(f(t)){const i=Math.round(Math.log(Math.max(n,c))/Math.LN2)+1;o.hasMipmap=o.hasMipmap&&i===t.levels.length;for(let s=0;;++s){const i=t.levels[Math.min(s,t.levels.length-1)];if(r.compressedTexImage2D(e,s,l,n,c,0,i),1===n&&1===c||!o.hasMipmap)break;n=Math.max(1,n>>1),c=Math.max(1,c>>1)}}else if(Object(i["l"])(t))r.texImage2D(e,0,l,n,c,0,a,o.dataType,t),Object(s["a"])(r),o.hasMipmap&&this.generateMipmap();else for(let t=0;r.texImage2D(e,t,l,n,c,0,a,o.dataType,null),Object(s["a"])(r),(1!==n||1!==c)&&o.hasMipmap;++t)n=Math.max(1,n>>1),c=Math.max(1,c>>1)}u._applySamplingMode(r,this._descriptor),u._applyWrapMode(r,this._descriptor),u._applyAnisotropicFilteringParameters(this._context,this._descriptor),Object(s["a"])(r),this._context.bindTexture(n,u.TEXTURE_UNIT_FOR_UPDATES)}updateData(t,e,r,n,i,s,o=3553){s||console.error("An attempt to use uninitialized data!"),this._glName||console.error("An attempt to update uninitialized texture!");const a=this._context.gl,c=this._descriptor,f=this._context.bindTexture(this,u.TEXTURE_UNIT_FOR_UPDATES);(e<0||r<0||n>c.width||i>c.height||e+n>c.width||r+i>c.height)&&console.error("An attempt to update out of bounds of the texture!"),a.pixelStorei(a.UNPACK_ALIGNMENT,c.unpackAlignment),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,c.flipped?1:0),a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,c.preMultiplyAlpha?1:0),s instanceof ImageData||s instanceof HTMLImageElement||s instanceof HTMLCanvasElement||s instanceof HTMLVideoElement?a.texSubImage2D(o,t,e,r,c.pixelFormat,c.dataType,s):a.texSubImage2D(o,t,e,r,n,i,c.pixelFormat,c.dataType,s),this._context.bindTexture(f,u.TEXTURE_UNIT_FOR_UPDATES)}generateMipmap(){const t=this._descriptor;t.hasMipmap||(t.hasMipmap=!0,this._samplingModeDirty=!0,u._validateTexture(this._context,t)),9729===t.samplingMode?(this._samplingModeDirty=!0,t.samplingMode=9985):9728===t.samplingMode&&(this._samplingModeDirty=!0,t.samplingMode=9984);const e=this._context.bindTexture(this,u.TEXTURE_UNIT_FOR_UPDATES);this._context.gl.generateMipmap(t.target),this._context.bindTexture(e,u.TEXTURE_UNIT_FOR_UPDATES)}setSamplingMode(t){t!==this._descriptor.samplingMode&&(this._descriptor.samplingMode=t,this._samplingModeDirty=!0)}setWrapMode(t){t!==this._descriptor.wrapMode&&(this._descriptor.wrapMode=t,u._validateTexture(this._context,this._descriptor),this._wrapModeDirty=!0)}applyChanges(){const t=this._context.gl,e=this._descriptor;this._samplingModeDirty&&(u._applySamplingMode(t,e),this._samplingModeDirty=!1),this._wrapModeDirty&&(u._applyWrapMode(t,e),this._wrapModeDirty=!1)}_deriveInternalFormat(t,e){if("webgl"===this._context.webglVersion)return t;if(5126===e)switch(t){case 6408:return 34836;case 6407:return 34837;default:throw new Error("Unable to derive format")}return t}static _validateTexture(t,e){(e.width<0||e.height<0)&&console.error("Negative dimension parameters are not allowed!");const r=Object(n["h"])(e.width)&&Object(n["h"])(e.height);Object(a["a"])(t.gl)||r||("number"==typeof e.wrapMode?33071!==e.wrapMode&&console.error("Non-power-of-two textures must have a wrap mode of CLAMP_TO_EDGE!"):33071===e.wrapMode.s&&33071===e.wrapMode.t||console.error("Non-power-of-two textures must have a wrap mode of CLAMP_TO_EDGE!"),e.hasMipmap&&console.error("Mipmapping requires power-of-two textures!"))}static _applySamplingMode(t,e){let r=e.samplingMode,n=e.samplingMode;9985===r||9987===r?(r=9729,e.hasMipmap||(n=9729)):9984!==r&&9986!==r||(r=9728,e.hasMipmap||(n=9728)),t.texParameteri(e.target,t.TEXTURE_MAG_FILTER,r),t.texParameteri(e.target,t.TEXTURE_MIN_FILTER,n)}static _applyWrapMode(t,e){"number"==typeof e.wrapMode?(t.texParameteri(e.target,t.TEXTURE_WRAP_S,e.wrapMode),t.texParameteri(e.target,t.TEXTURE_WRAP_T,e.wrapMode)):(t.texParameteri(e.target,t.TEXTURE_WRAP_S,e.wrapMode.s),t.texParameteri(e.target,t.TEXTURE_WRAP_T,e.wrapMode.t))}static _applyAnisotropicFilteringParameters(t,e){var r;const n=t.capabilities.textureFilterAnisotropic;n&&t.gl.texParameterf(e.target,n.TEXTURE_MAX_ANISOTROPY,null!=(r=e.maxAnisotropy)?r:1)}}function f(t){return Object(i["l"])(t)&&"type"in t&&"compressed"===t.type}u.TEXTURE_UNIT_FOR_UPDATES=0},afe1:function(t,e,r){"use strict";function n(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function i(t){return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15]]}function s(t,e,r,n,i,s,o,a,c,u,f,l,d,h,p,b){return[t,e,r,n,i,s,o,a,c,u,f,l,d,h,p,b]}function o(t,e){return new Float64Array(t,e,16)}r.d(e,"a",(function(){return a})),r.d(e,"b",(function(){return o})),r.d(e,"c",(function(){return i})),r.d(e,"d",(function(){return n})),r.d(e,"e",(function(){return s}));const a=n();Object.freeze({__proto__:null,create:n,clone:i,fromValues:s,createView:o,IDENTITY:a})},b139:function(t,e,r){"use strict";function n(){return[0,0,0,1]}function i(t){return[t[0],t[1],t[2],t[3]]}function s(t,e,r,n){return[t,e,r,n]}function o(t,e){return new Float64Array(t,e,4)}r.d(e,"a",(function(){return a})),r.d(e,"b",(function(){return n})),r.d(e,"c",(function(){return i})),r.d(e,"d",(function(){return o}));const a=n();Object.freeze({__proto__:null,create:n,clone:i,fromValues:s,createView:o,IDENTITY:a})},b623:function(t,e,r){"use strict";r.d(e,"a",(function(){return c})),r.d(e,"b",(function(){return l})),r.d(e,"c",(function(){return d})),r.d(e,"d",(function(){return f})),r.d(e,"e",(function(){return u}));var n=r("b2b2"),i=r("d791"),s=r("afe1"),o=r("1153"),a=r("9cc4");function c(t,e){return Object(n["k"])(t)&&(t=[]),t.push(e),t}function u(t,e){if(Object(n["k"])(t))return null;const r=t.filter(t=>t!==e);return 0===r.length?null:r}function f(t){return!!Object(n["l"])(t)&&!t.visible}function l(t,e,r){const s=t.origin.vec3;Object(o["i"])(b,-s[0],-s[1],-s[2]),Object(n["l"])(t.transformation)?Object(i["n"])(e,b,t.transformation):Object(i["d"])(e,b),r&&(Object(i["c"])(r,e),Object(i["t"])(r,r))}function d(t,e,r,n,i){h[0]=t.get(e,0),h[1]=t.get(e,1),h[2]=t.get(e,2),Object(a["a"])(h,p,3),r.set(i,0,p[0]),n.set(i,0,p[1]),r.set(i,1,p[2]),n.set(i,1,p[3]),r.set(i,2,p[4]),n.set(i,2,p[5])}const h=new Float64Array(3),p=new Float32Array(6),b=Object(s["d"])()},bd75:function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=r("3886");function i(t,e){0===e.output&&e.receiveShadows?(t.varyings.add("linearDepth","float"),t.vertex.code.add(n["a"]`void forwardLinearDepth() { linearDepth = gl_Position.w; }`)):1===e.output||3===e.output?(t.varyings.add("linearDepth","float"),t.vertex.uniforms.add("cameraNearFar","vec2"),t.vertex.code.add(n["a"]`void forwardLinearDepth() {
linearDepth = (-position_view().z - cameraNearFar[0]) / (cameraNearFar[1] - cameraNearFar[0]);
}`)):t.vertex.code.add(n["a"]`void forwardLinearDepth() {}`)}},bd7e:function(t,e,r){"use strict";r.d(e,"a",(function(){return g})),r.d(e,"b",(function(){return m})),r.d(e,"c",(function(){return f})),r.d(e,"d",(function(){return c})),r.d(e,"e",(function(){return h})),r.d(e,"f",(function(){return d})),r.d(e,"g",(function(){return l})),r.d(e,"h",(function(){return p})),r.d(e,"i",(function(){return b}));var n=r("38a4"),i=r("2119"),s=r("e431"),o=r("0b2d"),a=r("7361");function c(t){return t?{origin:Object(o["d"])(t.origin),vector:Object(o["d"])(t.vector)}:{origin:Object(o["f"])(),vector:Object(o["f"])()}}function u(t,e){const r=_.get();return r.origin=t,r.vector=e,r}function f(t,e=c()){return l(t.origin,t.vector,e)}function l(t,e,r=c()){return Object(s["k"])(r.origin,t),Object(s["k"])(r.vector,e),r}function d(t,e,r=c()){return Object(s["k"])(r.origin,t),Object(s["j"])(r.vector,e,t),r}function h(t,e){const r=Object(s["j"])(a["d"].get(),e,t.origin),i=Object(s["h"])(t.vector,r),o=Object(s["h"])(t.vector,t.vector),c=Object(n["d"])(i/o,0,1),u=Object(s["j"])(a["d"].get(),Object(s["e"])(a["d"].get(),t.vector,c),r);return Object(s["h"])(u,u)}function p(t,e,r){return Object(s["f"])(r,t.origin,Object(s["e"])(r,t.vector,e))}function b(t,e,r,i,o){const{vector:c,origin:u}=t,f=Object(s["j"])(a["d"].get(),e,u),l=Object(s["h"])(c,f)/Object(s["t"])(c);return Object(s["e"])(o,c,Object(n["d"])(l,r,i)),Object(s["f"])(o,o,t.origin)}function m(t,e){if(v(t,u(e.origin,e.direction),!1,y)){const{tA:e,pB:r,distance2:n}=y;if(e>=0&&e<=1)return n;if(e<0)return Object(s["l"])(t.origin,r);if(e>1)return Object(s["l"])(Object(s["f"])(a["d"].get(),t.origin,t.vector),r)}return null}function g(t,e,r){return!!v(t,e,!0,y)&&(Object(s["k"])(r,y.pA),!0)}function v(t,e,r,i){const o=1e-6,c=t.origin,u=Object(s["f"])(a["d"].get(),c,t.vector),f=e.origin,l=Object(s["f"])(a["d"].get(),f,e.vector),d=a["d"].get(),h=a["d"].get();if(d[0]=c[0]-f[0],d[1]=c[1]-f[1],d[2]=c[2]-f[2],h[0]=l[0]-f[0],h[1]=l[1]-f[1],h[2]=l[2]-f[2],Math.abs(h[0])<o&&Math.abs(h[1])<o&&Math.abs(h[2])<o)return!1;const p=a["d"].get();if(p[0]=u[0]-c[0],p[1]=u[1]-c[1],p[2]=u[2]-c[2],Math.abs(p[0])<o&&Math.abs(p[1])<o&&Math.abs(p[2])<o)return!1;const b=d[0]*h[0]+d[1]*h[1]+d[2]*h[2],m=h[0]*p[0]+h[1]*p[1]+h[2]*p[2],g=d[0]*p[0]+d[1]*p[1]+d[2]*p[2],v=h[0]*h[0]+h[1]*h[1]+h[2]*h[2],y=(p[0]*p[0]+p[1]*p[1]+p[2]*p[2])*v-m*m;if(Math.abs(y)<o)return!1;let _=(b*m-g*v)/y,O=(b+m*_)/v;r&&(_=Object(n["d"])(_,0,1),O=Object(n["d"])(O,0,1));const x=a["d"].get(),T=a["d"].get();return x[0]=c[0]+_*p[0],x[1]=c[1]+_*p[1],x[2]=c[2]+_*p[2],T[0]=f[0]+O*h[0],T[1]=f[1]+O*h[1],T[2]=f[2]+O*h[2],i.tA=_,i.tB=O,i.pA=x,i.pB=T,i.distance2=Object(s["l"])(x,T),!0}const y={tA:0,tB:0,pA:Object(o["f"])(),pB:Object(o["f"])(),distance2:0},_=new i["a"](()=>({origin:null,vector:null}))},be24:function(t,e,r){"use strict";r.d(e,"a",(function(){return i})),r.d(e,"b",(function(){return s})),r.d(e,"c",(function(){return a})),r.d(e,"d",(function(){return o}));var n=r("3886");function i(t,e){e.vvInstancingEnabled&&(e.vvSize||e.vvColor)&&t.attributes.add("instanceFeatureAttribute","vec4"),e.vvSize?(t.vertex.uniforms.add("vvSizeMinSize","vec3"),t.vertex.uniforms.add("vvSizeMaxSize","vec3"),t.vertex.uniforms.add("vvSizeOffset","vec3"),t.vertex.uniforms.add("vvSizeFactor","vec3"),t.vertex.uniforms.add("vvSymbolRotationMatrix","mat3"),t.vertex.uniforms.add("vvSymbolAnchor","vec3"),t.vertex.code.add(n["a"]`vec3 vvScale(vec4 _featureAttribute) {
return clamp(vvSizeOffset + _featureAttribute.x * vvSizeFactor, vvSizeMinSize, vvSizeMaxSize);
}
vec4 vvTransformPosition(vec3 position, vec4 _featureAttribute) {
return vec4(vvSymbolRotationMatrix * ( vvScale(_featureAttribute) * (position + vvSymbolAnchor)), 1.0);
}`),t.vertex.code.add(n["a"]`
      const float eps = 1.192092896e-07;
      vec4 vvTransformNormal(vec3 _normal, vec4 _featureAttribute) {
        vec3 vvScale = clamp(vvSizeOffset + _featureAttribute.x * vvSizeFactor, vvSizeMinSize + eps, vvSizeMaxSize);
        return vec4(vvSymbolRotationMatrix * _normal / vvScale, 1.0);
      }

      ${e.vvInstancingEnabled?n["a"]`
      vec4 vvLocalNormal(vec3 _normal) {
        return vvTransformNormal(_normal, instanceFeatureAttribute);
      }

      vec4 localPosition() {
        return vvTransformPosition(position, instanceFeatureAttribute);
      }`:""}
    `)):t.vertex.code.add(n["a"]`vec4 localPosition() { return vec4(position, 1.0); }
vec4 vvLocalNormal(vec3 _normal) { return vec4(_normal, 1.0); }`),e.vvColor?(t.vertex.constants.add("vvColorNumber","int",8),t.vertex.code.add(n["a"]`
      uniform float vvColorValues[vvColorNumber];
      uniform vec4 vvColorColors[vvColorNumber];

      vec4 vvGetColor(vec4 featureAttribute, float values[vvColorNumber], vec4 colors[vvColorNumber]) {
        float value = featureAttribute.y;
        if (value <= values[0]) {
          return colors[0];
        }

        for (int i = 1; i < vvColorNumber; ++i) {
          if (values[i] >= value) {
            float f = (value - values[i-1]) / (values[i] - values[i-1]);
            return mix(colors[i-1], colors[i], f);
          }
        }
        return colors[vvColorNumber - 1];
      }

      ${e.vvInstancingEnabled?n["a"]`
      vec4 vvColor() {
        return vvGetColor(instanceFeatureAttribute, vvColorValues, vvColorColors);
      }`:""}
    `)):t.vertex.code.add(n["a"]`vec4 vvColor() { return vec4(1.0); }`)}function s(t,e){e.vvSizeEnabled&&(t.setUniform3fv("vvSizeMinSize",e.vvSizeMinSize),t.setUniform3fv("vvSizeMaxSize",e.vvSizeMaxSize),t.setUniform3fv("vvSizeOffset",e.vvSizeOffset),t.setUniform3fv("vvSizeFactor",e.vvSizeFactor)),e.vvColorEnabled&&(t.setUniform1fv("vvColorValues",e.vvColorValues),t.setUniform4fv("vvColorColors",e.vvColorColors))}function o(t,e){s(t,e),e.vvOpacityEnabled&&(t.setUniform1fv("vvOpacityValues",e.vvOpacityValues),t.setUniform1fv("vvOpacityOpacities",e.vvOpacityOpacities))}function a(t,e){s(t,e),e.vvSizeEnabled&&(t.setUniform3fv("vvSymbolAnchor",e.vvSymbolAnchor),t.setUniformMatrix3fv("vvSymbolRotationMatrix",e.vvSymbolRotationMatrix))}},c2d1:function(t,e,r){"use strict";r.d(e,"a",(function(){return s}));var n=r("501b"),i=r("3886");function s(t,e){t.fragment.include(n["a"]),3===e.output?(t.extensions.add("GL_OES_standard_derivatives"),t.fragment.code.add(i["a"]`float _calculateFragDepth(const in float depth) {
const float SLOPE_SCALE = 2.0;
const float BIAS = 2.0 * .000015259;
float m = max(abs(dFdx(depth)), abs(dFdy(depth)));
float result = depth + SLOPE_SCALE * m + BIAS;
return clamp(result, .0, .999999);
}
void outputDepth(float _linearDepth) {
gl_FragColor = float2rgba(_calculateFragDepth(_linearDepth));
}`)):1===e.output&&t.fragment.code.add(i["a"]`void outputDepth(float _linearDepth) {
gl_FragColor = float2rgba(_linearDepth);
}`)}},c3a4:function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));class n{constructor(t,e){this._module=t,this._loadModule=e}get(){return this._module}async reload(){return this._module=await this._loadModule(),this._module}}},c514:function(t,e,r){"use strict";function n(t){return window.WebGL2RenderingContext&&t instanceof window.WebGL2RenderingContext}r.d(e,"a",(function(){return n}))},c51b:function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=r("3886");function i(t){t.vertex.code.add(n["a"]`const float PI = 3.141592653589793;`),t.fragment.code.add(n["a"]`const float PI = 3.141592653589793;
const float LIGHT_NORMALIZATION = 1.0 / PI;
const float INV_PI = 0.3183098861837907;
const float HALF_PI = 1.570796326794897;`)}},c6ac:function(t,e,r){"use strict";r.d(e,"a",(function(){return n})),r.d(e,"b",(function(){return s})),r.d(e,"c",(function(){return i})),r.d(e,"d",(function(){return o}));r("c120");function n(t){switch(t){case"u8":case"i8":return 1;case"u16":case"i16":return 2;case"u32":case"i32":case"f32":return 4;case"f64":return 8;default:return}}function i(t){switch(t){case"u8":case"u16":case"u32":return!1;case"i8":case"i16":case"i32":case"f32":case"f64":return!0;default:return}}function s(t){switch(t){case"u8":case"u16":case"u32":case"i8":case"i16":case"i32":return!0;case"f32":case"f64":return!1;default:return}}function o(t){switch(t){case"u8":return 255;case"u16":return 65535;case"u32":return 4294967295;case"i8":return 127;case"i16":return 32767;case"i32":return 2147483647;case"f32":return 3402823e32;case"f64":return 179769e303;default:return}}},c6d7:function(t,e,r){"use strict";r.d(e,"a",(function(){return s})),r.d(e,"b",(function(){return i}));var n=r("3886");function i(t,e){t.fragment.uniforms.add("terrainDepthTexture","sampler2D"),t.fragment.uniforms.add("cameraNearFar","vec2"),t.fragment.uniforms.add("inverseViewport","vec2"),t.fragment.code.add(n["a"]`
    // Compare the linearized depths of fragment and terrain. Discard fragments on the wrong side of the terrain.
    void terrainDepthTest(vec4 fragCoord, float fragmentDepth){

      float terrainDepth = linearDepthFromTexture(terrainDepthTexture, fragCoord.xy * inverseViewport, cameraNearFar);
      if(fragmentDepth ${e.cullAboveGround?">":"<="} terrainDepth){
        discard;
      }
    }
  `)}function s(t,e){e.multipassTerrainEnabled&&e.terrainLinearDepthTexture&&t.bindTexture(e.terrainLinearDepthTexture,"terrainDepthTexture")}},c829:function(t,e,r){"use strict";r.d(e,"a",(function(){return a}));var n=r("b2b2"),i=r("8a44"),s=r("1956"),o=r("8e37");class a extends o["a"]{constructor(t,e,r){super(t,e.generateSource("vertex"),e.generateSource("fragment"),r),this._textures=new Map,this._freeTextureUnits=new i["a"]({deallocator:null}),this._fragmentUniforms=Object(s["b"])()?e.fragmentUniforms.entries:null}stop(){this._textures.clear(),this._freeTextureUnits.clear()}bindTexture(t,e){if(Object(n["k"])(t)||null==t.glName){const t=this._textures.get(e);return t&&(this._context.bindTexture(null,t.unit),this._freeTextureUnit(t),this._textures.delete(e)),null}let r=this._textures.get(e);return null==r?(r=this._allocTextureUnit(t),this._textures.set(e,r)):r.texture=t,this._context.useProgram(this),this.setUniform1i(e,r.unit),this._context.bindTexture(t,r.unit),r.unit}rebindTextures(){this._context.useProgram(this),this._textures.forEach((t,e)=>{this._context.bindTexture(t.texture,t.unit),this.setUniform1i(e,t.unit)}),Object(n["l"])(this._fragmentUniforms)&&this._fragmentUniforms.forEach(t=>{if(("sampler2D"===t.type||"samplerCube"===t.type)&&!this._textures.has(t.name))throw new Error(`Texture sampler ${t.name} has no bound texture`)})}_allocTextureUnit(t){return{texture:t,unit:0===this._freeTextureUnits.length?this._textures.size:this._freeTextureUnits.pop()}}_freeTextureUnit(t){this._freeTextureUnits.push(t.unit)}}},ca98:function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=r("b2b2");class i{constructor(t,e,r=(()=>this.dispose())){this.release=r,e&&(this._config=e.snapshot()),this._program=this.initializeProgram(t),this._pipeline=this.initializePipeline(t)}dispose(){this._program=Object(n["f"])(this._program),this._pipeline=this._config=null}reload(t){Object(n["f"])(this._program),this._program=this.initializeProgram(t)}get program(){return this._program}get key(){return this._config.key}get configuration(){return this._config}bindPass(t,e){}bindMaterial(t,e){}bindDraw(t){}bindPipelineState(t,e=null,r){t.setPipelineState(this.getPipelineState(e,r))}ensureAttributeLocations(t){this.program.assertCompatibleVertexAttributeLocations(t)}get primitiveType(){return 4}getPipelineState(t,e){return this._pipeline}}},d017:function(t,e,r){"use strict";r.d(e,"a",(function(){return s})),r.d(e,"b",(function(){return o})),r.d(e,"c",(function(){return c})),r.d(e,"d",(function(){return a}));var n=r("501b"),i=r("3886");function s(t){t.fragment.include(n["a"]),t.fragment.uniforms.add("uShadowMapTex","sampler2D"),t.fragment.uniforms.add("uShadowMapNum","int"),t.fragment.uniforms.add("uShadowMapDistance","vec4"),t.fragment.uniforms.add("uShadowMapMatrix","mat4",4),t.fragment.uniforms.add("uDepthHalfPixelSz","float"),t.fragment.code.add(i["a"]`int chooseCascade(float _linearDepth, out mat4 mat) {
vec4 distance = uShadowMapDistance;
float depth = _linearDepth;
int i = depth < distance[1] ? 0 : depth < distance[2] ? 1 : depth < distance[3] ? 2 : 3;
mat = i == 0 ? uShadowMapMatrix[0] : i == 1 ? uShadowMapMatrix[1] : i == 2 ? uShadowMapMatrix[2] : uShadowMapMatrix[3];
return i;
}
vec3 lightSpacePosition(vec3 _vpos, mat4 mat) {
vec4 lv = mat * vec4(_vpos, 1.0);
lv.xy /= lv.w;
return 0.5 * lv.xyz + vec3(0.5);
}
vec2 cascadeCoordinates(int i, vec3 lvpos) {
return vec2(float(i - 2 * (i / 2)) * 0.5, float(i / 2) * 0.5) + 0.5 * lvpos.xy;
}
float readShadowMapDepth(vec2 uv, sampler2D _depthTex) {
return rgba2float(texture2D(_depthTex, uv));
}
float posIsInShadow(vec2 uv, vec3 lvpos, sampler2D _depthTex) {
return readShadowMapDepth(uv, _depthTex) < lvpos.z ? 1.0 : 0.0;
}
float filterShadow(vec2 uv, vec3 lvpos, float halfPixelSize, sampler2D _depthTex) {
float texSize = 0.5 / halfPixelSize;
vec2 st = fract((vec2(halfPixelSize) + uv) * texSize);
float s00 = posIsInShadow(uv + vec2(-halfPixelSize, -halfPixelSize), lvpos, _depthTex);
float s10 = posIsInShadow(uv + vec2(halfPixelSize, -halfPixelSize), lvpos, _depthTex);
float s11 = posIsInShadow(uv + vec2(halfPixelSize, halfPixelSize), lvpos, _depthTex);
float s01 = posIsInShadow(uv + vec2(-halfPixelSize, halfPixelSize), lvpos, _depthTex);
return mix(mix(s00, s10, st.x), mix(s01, s11, st.x), st.y);
}
float readShadowMap(const in vec3 _vpos, float _linearDepth) {
mat4 mat;
int i = chooseCascade(_linearDepth, mat);
if (i >= uShadowMapNum) { return 0.0; }
vec3 lvpos = lightSpacePosition(_vpos, mat);
if (lvpos.z >= 1.0) { return 0.0; }
if (lvpos.x < 0.0 || lvpos.x > 1.0 || lvpos.y < 0.0 || lvpos.y > 1.0) { return 0.0; }
vec2 uv = cascadeCoordinates(i, lvpos);
return filterShadow(uv, lvpos, uDepthHalfPixelSz, uShadowMapTex);
}`)}function o(t,e){e.shadowMappingEnabled&&(e.shadowMap.bind(t),e.shadowMap.bindView(t,e.origin))}function a(t,e,r){e.shadowMappingEnabled&&e.shadowMap.bindView(t,r)}function c(t,e){e.shadowMappingEnabled&&e.shadowMap.bindView(t,e.origin)}},d047:function(t,e,r){"use strict";r.d(e,"a",(function(){return s}));var n=r("501b"),i=r("3886");function s(t){t.include(n["a"]),t.code.add(i["a"]`float linearDepthFromFloat(float depth, vec2 nearFar) {
return -(depth * (nearFar[1] - nearFar[0]) + nearFar[0]);
}
float linearDepthFromTexture(sampler2D depthTex, vec2 uv, vec2 nearFar) {
return linearDepthFromFloat(rgba2float(texture2D(depthTex, uv)), nearFar);
}`)}},d17d:function(t,e,r){"use strict";r.d(e,"a",(function(){return n})),r.d(e,"b",(function(){return s})),r.d(e,"c",(function(){return i}));const n=33984;var i;!function(t){t[t.Texture=0]="Texture",t[t.Buffer=1]="Buffer",t[t.VAO=2]="VAO",t[t.VertexShader=3]="VertexShader",t[t.FragmentShader=4]="FragmentShader",t[t.Program=5]="Program",t[t.Framebuffer=6]="Framebuffer",t[t.Renderbuffer=7]="Renderbuffer",t[t.COUNT=8]="COUNT"}(i||(i={}));const s=33306},d18f:function(t,e,r){"use strict";r.d(e,"a",(function(){return h})),r.d(e,"b",(function(){return u})),r.d(e,"c",(function(){return a})),r.d(e,"d",(function(){return d})),r.d(e,"e",(function(){return f})),r.d(e,"f",(function(){return l})),r.d(e,"g",(function(){return c}));r("b50f");var n=r("2119"),i=r("e431"),s=r("0b2d"),o=r("7361");function a(t){return t?{origin:Object(s["d"])(t.origin),direction:Object(s["d"])(t.direction)}:{origin:Object(s["f"])(),direction:Object(s["f"])()}}function c(t,e){const r=b.get();return r.origin=t,r.direction=e,r}function u(t,e=a()){return l(t.origin,t.direction,e)}function f(t,e,r=a()){return Object(i["k"])(r.origin,t),Object(i["j"])(r.direction,e,t),r}function l(t,e,r=a()){return Object(i["k"])(r.origin,t),Object(i["k"])(r.direction,e),r}function d(t,e){const r=Object(i["g"])(o["d"].get(),Object(i["r"])(o["d"].get(),t.direction),Object(i["j"])(o["d"].get(),e,t.origin));return Object(i["h"])(r,r)}function h(t,e,r){const n=Object(i["h"])(t.direction,Object(i["j"])(r,e,t.origin));return Object(i["f"])(r,t.origin,Object(i["e"])(r,t.direction,n)),r}function p(){return{origin:null,direction:null}}const b=new n["a"](p)},d272:function(t,e,r){"use strict";r.d(e,"a",(function(){return a})),r.d(e,"b",(function(){return u})),r.d(e,"c",(function(){return c}));var n=r("b2b2"),i=r("e431"),s=r("0b2d"),o=r("3886");function a(t,e){if(e.slicePlaneEnabled){t.extensions.add("GL_OES_standard_derivatives"),e.sliceEnabledForVertexPrograms&&(t.vertex.uniforms.add("slicePlaneOrigin","vec3"),t.vertex.uniforms.add("slicePlaneBasis1","vec3"),t.vertex.uniforms.add("slicePlaneBasis2","vec3")),t.fragment.uniforms.add("slicePlaneOrigin","vec3"),t.fragment.uniforms.add("slicePlaneBasis1","vec3"),t.fragment.uniforms.add("slicePlaneBasis2","vec3");const r=o["a"]`struct SliceFactors {
float front;
float side0;
float side1;
float side2;
float side3;
};
SliceFactors calculateSliceFactors(vec3 pos) {
vec3 rel = pos - slicePlaneOrigin;
vec3 slicePlaneNormal = -cross(slicePlaneBasis1, slicePlaneBasis2);
float slicePlaneW = -dot(slicePlaneNormal, slicePlaneOrigin);
float basis1Len2 = dot(slicePlaneBasis1, slicePlaneBasis1);
float basis2Len2 = dot(slicePlaneBasis2, slicePlaneBasis2);
float basis1Dot = dot(slicePlaneBasis1, rel);
float basis2Dot = dot(slicePlaneBasis2, rel);
return SliceFactors(
dot(slicePlaneNormal, pos) + slicePlaneW,
-basis1Dot - basis1Len2,
basis1Dot - basis1Len2,
-basis2Dot - basis2Len2,
basis2Dot - basis2Len2
);
}
bool sliceByFactors(SliceFactors factors) {
return factors.front < 0.0
&& factors.side0 < 0.0
&& factors.side1 < 0.0
&& factors.side2 < 0.0
&& factors.side3 < 0.0;
}
bool sliceEnabled() {
return dot(slicePlaneBasis1, slicePlaneBasis1) != 0.0;
}
bool sliceByPlane(vec3 pos) {
return sliceEnabled() && sliceByFactors(calculateSliceFactors(pos));
}
#define rejectBySlice(_pos_) sliceByPlane(_pos_)
#define discardBySlice(_pos_) { if (sliceByPlane(_pos_)) discard; }`,n=o["a"]`vec4 applySliceHighlight(vec4 color, vec3 pos) {
SliceFactors factors = calculateSliceFactors(pos);
if (sliceByFactors(factors)) {
return color;
}
const float HIGHLIGHT_WIDTH = 1.0;
const vec4 HIGHLIGHT_COLOR = vec4(0.0, 0.0, 0.0, 0.3);
factors.front /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.front);
factors.side0 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side0);
factors.side1 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side1);
factors.side2 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side2);
factors.side3 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side3);
float highlightFactor = (1.0 - step(0.5, factors.front))
* (1.0 - step(0.5, factors.side0))
* (1.0 - step(0.5, factors.side1))
* (1.0 - step(0.5, factors.side2))
* (1.0 - step(0.5, factors.side3));
return mix(color, vec4(HIGHLIGHT_COLOR.rgb, color.a), highlightFactor * HIGHLIGHT_COLOR.a);
}`,i=e.sliceHighlightDisabled?o["a"]`#define highlightSlice(_color_, _pos_) (_color_)`:o["a"]`
        ${n}
        #define highlightSlice(_color_, _pos_) (sliceEnabled() ? applySliceHighlight(_color_, _pos_) : (_color_))
      `;e.sliceEnabledForVertexPrograms&&t.vertex.code.add(r),t.fragment.code.add(r),t.fragment.code.add(i)}else{const r=o["a"]`#define rejectBySlice(_pos_) false
#define discardBySlice(_pos_) {}
#define highlightSlice(_color_, _pos_) (_color_)`;e.sliceEnabledForVertexPrograms&&t.vertex.code.add(r),t.fragment.code.add(r)}}function c(t,e,r){u(t,e,r.slicePlane,r.origin)}function u(t,e,r,o){e.slicePlaneEnabled&&(Object(n["l"])(r)?(o?(Object(i["j"])(f,r.origin,o),t.setUniform3fv("slicePlaneOrigin",f)):t.setUniform3fv("slicePlaneOrigin",r.origin),t.setUniform3fv("slicePlaneBasis1",r.basis1),t.setUniform3fv("slicePlaneBasis2",r.basis2)):(t.setUniform3fv("slicePlaneBasis1",s["c"]),t.setUniform3fv("slicePlaneBasis2",s["c"]),t.setUniform3fv("slicePlaneOrigin",s["c"])))}const f=Object(s["f"])()},d5f7:function(t,e,r){"use strict";r.d(e,"a",(function(){return f})),r.d(e,"b",(function(){return u}));var n=r("fa1e");const i=[{name:"position",count:2,type:5126,offset:0,stride:8,normalized:!1}],s=[{name:"position",count:2,type:5126,offset:0,stride:16,normalized:!1},{name:"uv0",count:2,type:5126,offset:8,stride:16,normalized:!1}];var o=r("7ce4"),a=r("a1ff"),c=r("0fa6");function u(t,e=i,r=n["a"],a=-1,u=1){let f=null;return f=e===s?new Float32Array([a,a,0,0,u,a,1,0,a,u,0,1,u,u,1,1]):new Float32Array([a,a,u,a,a,u,u,u]),new c["a"](t,r,{geometry:e},{geometry:o["a"].createVertex(t,35044,f)})}function f(t){return new a["a"](t,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1},new Uint8Array([255,255,255,255]))}},d7f7:function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));class n{constructor(t){this._material=t.material,this._techniqueRep=t.techniqueRep,this._output=t.output}dispose(){this._techniqueRep.release(this._technique)}get technique(){return this._technique}ensureTechnique(t,e,r=this._output){return this._technique=this._techniqueRep.releaseAndAcquire(t,this._material.getTechniqueConfig(r,e),this._technique),this._technique}ensureResources(t){return 2}}},da1c:function(t,e,r){"use strict";r.d(e,"a",(function(){return f})),r.d(e,"b",(function(){return a})),r.d(e,"c",(function(){return u})),r.d(e,"d",(function(){return l}));var n=r("38a4");function i(t){return Math.abs(t*t*t)}function s(t,e,r){const n=r.parameters,s=r.paddingPixelsOverride;return d.scale=Math.min(n.divisor/(e-n.offset),1),d.factor=i(t),d.minPixelSize=n.minPixelSize,d.paddingPixels=s,d}function o(t,e){return 0===t?e.minPixelSize:e.minPixelSize*(1+2*e.paddingPixels/t)}function a(t,e){return Math.max(Object(n["i"])(t*e.scale,t,e.factor),o(t,e))}function c(t,e,r){const n=s(t,e,r);return n.minPixelSize=0,n.paddingPixels=0,a(1,n)}function u(t,e,r,n){n.scale=c(t,e,r),n.factor=0,n.minPixelSize=r.parameters.minPixelSize,n.paddingPixels=r.paddingPixelsOverride}function f(t,e,r=[0,0]){const n=Math.min(Math.max(e.scale,o(t[1],e)/t[1]),1);return r[0]=t[0]*n,r[1]=t[1]*n,r}function l(t,e,r,n){return a(t,s(e,r,n))}Object(n["f"])(10),Object(n["f"])(12),Object(n["f"])(70),Object(n["f"])(40);const d={scale:0,factor:0,minPixelSize:0,paddingPixels:0}},da35:function(t,e,r){"use strict";r.d(e,"a",(function(){return n})),r.d(e,"b",(function(){return i}));class n{constructor(){this._key="",this._keyDirty=!1,this._parameterBits=this._parameterBits?this._parameterBits.map(()=>0):[],this._parameterNames||(this._parameterNames=[])}get key(){return this._keyDirty&&(this._keyDirty=!1,this._key=String.fromCharCode.apply(String,this._parameterBits)),this._key}snapshot(){const t=this._parameterNames,e={key:this.key};for(const r of t)e[r]=this[r];return e}}function i(t={}){return(e,r)=>{var n,i;e._parameterNames=null!=(n=e._parameterNames)?n:[],e._parameterNames.push(r);const s=e._parameterNames.length-1,o=t.count||2,a=Math.ceil(Math.log2(o)),c=null!=(i=e._parameterBits)?i:[0];let u=0;for(;c[u]+a>16;)u++,u>=c.length&&c.push(0);e._parameterBits=c;const f=c[u],l=(1<<a)-1<<f;c[u]+=a,Object.defineProperty(e,r,{get(){return this[s]},set(t){if(this[s]!==t&&(this[s]=t,this._keyDirty=!0,this._parameterBits[u]=this._parameterBits[u]&~l|+t<<f&l,"number"!=typeof t&&"boolean"!=typeof t))throw"Configuration value for "+r+" must be boolean or number, got "+typeof t}})}}},dae5:function(t,e,r){"use strict";function n(){return[1,0,0,0,1,0,0,0,1]}function i(t){return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8]]}function s(t,e,r,n,i,s,o,a,c){return[t,e,r,n,i,s,o,a,c]}function o(t,e){return new Float64Array(t,e,9)}r.d(e,"a",(function(){return o})),r.d(e,"b",(function(){return n}));Object.freeze({__proto__:null,create:n,clone:i,fromValues:s,createView:o})},ebd5:function(t,e,r){"use strict";r.d(e,"a",(function(){return o})),r.d(e,"b",(function(){return i})),r.d(e,"c",(function(){return s}));var n=r("3886");const i=.1,s=.001;function o(t,e){const r=t.fragment;switch(e.alphaDiscardMode){case 0:r.code.add(n["a"]`
        #define discardOrAdjustAlpha(color) { if (color.a < ${n["a"].float(s)}) { discard; } }
      `);break;case 1:r.code.add(n["a"]`void discardOrAdjustAlpha(inout vec4 color) {
color.a = 1.0;
}`);break;case 2:r.uniforms.add("textureAlphaCutoff","float"),r.code.add(n["a"]`#define discardOrAdjustAlpha(color) { if (color.a < textureAlphaCutoff) { discard; } else { color.a = 1.0; } }`);break;case 3:t.fragment.uniforms.add("textureAlphaCutoff","float"),t.fragment.code.add(n["a"]`#define discardOrAdjustAlpha(color) { if (color.a < textureAlphaCutoff) { discard; } }`)}}},f895:function(t,e,r){"use strict";r.d(e,"a",(function(){return y})),r.d(e,"b",(function(){return m})),r.d(e,"c",(function(){return b})),r.d(e,"d",(function(){return T})),r.d(e,"e",(function(){return x})),r.d(e,"f",(function(){return A})),r.d(e,"g",(function(){return V})),r.d(e,"h",(function(){return v}));r("c120");var n=r("e92d"),i=r("38a4"),s=r("b2b2"),o=r("d791"),a=r("e431"),c=r("0b2d"),u=r("7577"),f=r("0fc4"),l=r("d18f"),d=r("a1b1"),h=r("7361");const p=n["a"].getLogger("esri.geometry.support.sphere");function b(){return Object(f["e"])()}function m(t,e=b()){return Object(u["c"])(e,t)}function g(t,e){return Object(f["g"])(t[0],t[1],t[2],e)}function v(t){return t}function y(t){t[0]=t[1]=t[2]=t[3]=0}function _(t){return t}function O(t){return Array.isArray(t)?t[3]:t}function x(t){return Array.isArray(t)?t:R}function T(t,e,r,n){return Object(f["g"])(t,e,r,n)}function S(t,e,r){return t!==r&&Object(a["k"])(r,t),r[3]=t[3]+e,r}function w(t,e,r){return p.error("sphere.setExtent is not yet supported"),t===r?r:m(t,r)}function M(t,e,r){if(Object(s["k"])(e))return!1;const{origin:n,direction:i}=e,o=j;o[0]=n[0]-t[0],o[1]=n[1]-t[1],o[2]=n[2]-t[2];const a=i[0]*i[0]+i[1]*i[1]+i[2]*i[2],c=2*(i[0]*o[0]+i[1]*o[1]+i[2]*o[2]),u=c*c-4*a*(o[0]*o[0]+o[1]*o[1]+o[2]*o[2]-t[3]*t[3]);if(u<0)return!1;const f=Math.sqrt(u);let l=(-c-f)/(2*a);const d=(-c+f)/(2*a);return(l<0||d<l&&d>0)&&(l=d),!(l<0)&&(r&&(r[0]=n[0]+i[0]*l,r[1]=n[1]+i[1]*l,r[2]=n[2]+i[2]*l),!0)}const j=Object(c["f"])();function A(t,e){return M(t,e,null)}function E(t,e,r){if(M(t,e,r))return r;const n=P(t,e,h["d"].get());return Object(a["f"])(r,e.origin,Object(a["e"])(h["d"].get(),e.direction,Object(a["m"])(e.origin,n)/Object(a["p"])(e.direction))),r}function P(t,e,r){const n=h["d"].get(),i=h["a"].get();Object(a["g"])(n,e.origin,e.direction);const s=O(t);Object(a["g"])(r,n,e.origin),Object(a["e"])(r,r,1/Object(a["p"])(r)*s);const c=L(t,e.origin),u=Object(d["a"])(e.origin,r);return Object(o["j"])(i),Object(o["f"])(i,i,u+c,n),Object(a["q"])(r,r,i),r}function B(t,e,r){return M(t,e,r)?r:(Object(l["a"])(e,x(t),r),I(t,r,r))}function I(t,e,r){const n=Object(a["j"])(h["d"].get(),e,x(t)),i=Object(a["e"])(h["d"].get(),n,t[3]/Object(a["p"])(n));return Object(a["f"])(r,i,x(t))}function F(t,e){const r=Object(a["j"])(h["d"].get(),e,x(t)),n=Object(a["t"])(r),i=t[3]*t[3];return Math.sqrt(Math.abs(n-i))}function L(t,e){const r=Object(a["j"])(h["d"].get(),e,x(t)),n=Object(a["p"])(r),s=O(t),o=s+Math.abs(s-n);return Object(i["a"])(s/o)}const z=Object(c["f"])();function C(t,e,r,n){const s=Object(a["j"])(z,e,x(t));switch(r){case 0:{const t=Object(i["c"])(s,z)[2];return Object(a["w"])(n,-Math.sin(t),Math.cos(t),0)}case 1:{const t=Object(i["c"])(s,z),e=t[1],r=t[2],o=Math.sin(e);return Object(a["w"])(n,-o*Math.cos(r),-o*Math.sin(r),Math.cos(e))}case 2:return Object(a["r"])(n,s);default:return}}function D(t,e){const r=Object(a["j"])(U,e,x(t));return Object(a["p"])(r)-t[3]}function N(t,e,r,n){const i=D(t,e),s=C(t,e,2,U),o=Object(a["e"])(U,s,r-i);return Object(a["f"])(n,e,o)}const R=Object(c["f"])(),U=Object(c["f"])(),V=Object.freeze({__proto__:null,create:b,copy:m,fromCenterAndRadius:g,wrap:v,clear:y,fromRadius:_,getRadius:O,getCenter:x,fromValues:T,elevate:S,setExtent:w,intersectRay:M,intersectsRay:A,intersectRayClosestSilhouette:E,closestPointOnSilhouette:P,closestPoint:B,projectPoint:I,distanceToSilhouette:F,angleToSilhouette:L,axisAt:C,altitudeAt:D,setAltitudeAt:N})},fa1e:function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));const n=new Map([["position",0],["normal",1],["uv0",2],["color",3],["size",4],["tangent",4],["auxpos1",5],["symbolColor",5],["auxpos2",6],["featureAttribute",6],["instanceFeatureAttribute",6],["instanceColor",7],["model",8],["modelNormal",12],["modelOriginHi",11],["modelOriginLo",15]])},fc00:function(t,e,r){"use strict";r.d(e,"a",(function(){return a}));var n=r("8190"),i=r("c6ac");class s{constructor(t,e){this.layout=t,this.buffer="number"==typeof e?new ArrayBuffer(e*t.stride):e;for(const r of t.fieldNames){const e=t.fields.get(r);this[r]=new e.constructor(this.buffer,e.offset,this.stride)}}get stride(){return this.layout.stride}get count(){return this.buffer.byteLength/this.stride}get byteLength(){return this.buffer.byteLength}getField(t,e){const r=this[t];return r&&r.elementCount===e.ElementCount&&r.elementType===e.ElementType?r:null}slice(t,e){return new s(this.layout,this.buffer.slice(t*this.stride,e*this.stride))}copyFrom(t,e,r,n){const i=this.stride;if(i%4==0){const s=new Uint32Array(t.buffer,e*i,n*i/4);new Uint32Array(this.buffer,r*i,n*i/4).set(s)}else{const s=new Uint8Array(t.buffer,e*i,n*i);new Uint8Array(this.buffer,r*i,n*i).set(s)}}}class o{constructor(){this.stride=0,this.fields=new Map,this.fieldNames=[]}vec2f(t,e){return this.appendField(t,n["m"],e),this}vec2f64(t,e){return this.appendField(t,n["n"],e),this}vec3f(t,e){return this.appendField(t,n["u"],e),this}vec3f64(t,e){return this.appendField(t,n["v"],e),this}vec4f(t,e){return this.appendField(t,n["C"],e),this}vec4f64(t,e){return this.appendField(t,n["D"],e),this}mat3f(t,e){return this.appendField(t,n["f"],e),this}mat3f64(t,e){return this.appendField(t,n["g"],e),this}mat4f(t,e){return this.appendField(t,n["h"],e),this}mat4f64(t,e){return this.appendField(t,n["i"],e),this}vec4u8(t,e){return this.appendField(t,n["J"],e),this}f32(t,e){return this.appendField(t,n["a"],e),this}f64(t,e){return this.appendField(t,n["b"],e),this}u8(t,e){return this.appendField(t,n["l"],e),this}u16(t,e){return this.appendField(t,n["j"],e),this}i8(t,e){return this.appendField(t,n["e"],e),this}vec2i8(t,e){return this.appendField(t,n["q"],e),this}vec2i16(t,e){return this.appendField(t,n["o"],e),this}vec2u8(t,e){return this.appendField(t,n["t"],e),this}vec4u16(t,e){return this.appendField(t,n["H"],e),this}u32(t,e){return this.appendField(t,n["k"],e),this}appendField(t,e,r){const n=e.ElementCount*Object(i["a"])(e.ElementType),s=this.stride;this.fields.set(t,{size:n,constructor:e,offset:s,optional:r}),this.stride+=n,this.fieldNames.push(t)}alignTo(t){return this.stride=Math.floor((this.stride+t-1)/t)*t,this}hasField(t){return this.fieldNames.indexOf(t)>=0}createBuffer(t){return new s(this,t)}createView(t){return new s(this,t)}clone(){const t=new o;return t.stride=this.stride,t.fields=new Map,this.fields.forEach((e,r)=>t.fields.set(r,e)),t.fieldNames=this.fieldNames.slice(),t.BufferType=this.BufferType,t}}function a(){return new o}}}]);
//# sourceMappingURL=chunk-3659ce29.7bab3a5e.js.map